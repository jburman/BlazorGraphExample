/*! msal v1.1.1 2019-07-23 */
!function(n,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("Msal",[],t):"object"==typeof exports?exports.Msal=t():n.Msal=t()}(window,function(){function n(r){if(t[r])return t[r].exports;var u=t[r]={i:r,l:!1,exports:{}};return i[r].call(u.exports,u,u.exports,n),u.l=!0,u.exports}return t={},n.m=i=[function(n,t,i){function r(){}Object.defineProperty(t,"__esModule",{value:!0});var f=i(1),u=i(2),e=i(2),o=(r.compareAccounts=function(n,t){return!!(n&&t&&n.homeAccountIdentifier&&t.homeAccountIdentifier&&n.homeAccountIdentifier===t.homeAccountIdentifier)},r.decimalToHex=function(n){for(var t=n.toString(16);t.length<2;)t="0"+t;return t},r.getLibraryVersion=function(){return e.Library.version},r.createNewGuid=function(){var e=window.crypto,n;if(e&&e.getRandomValues)return n=new Uint8Array(16),e.getRandomValues(n),n[6]|=64,n[6]&=79,n[8]|=128,n[8]&=191,r.decimalToHex(n[0])+r.decimalToHex(n[1])+r.decimalToHex(n[2])+r.decimalToHex(n[3])+"-"+r.decimalToHex(n[4])+r.decimalToHex(n[5])+"-"+r.decimalToHex(n[6])+r.decimalToHex(n[7])+"-"+r.decimalToHex(n[8])+r.decimalToHex(n[9])+"-"+r.decimalToHex(n[10])+r.decimalToHex(n[11])+r.decimalToHex(n[12])+r.decimalToHex(n[13])+r.decimalToHex(n[14])+r.decimalToHex(n[15]);for(var i="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx",o="0123456789abcdef",u=0,f="",t=0;t<36;t++)"-"!==i[t]&&"4"!==i[t]&&(u=16*Math.random()|0),"x"===i[t]?f+=o[u]:"y"===i[t]?(u&=3,f+=o[u|=8]):f+=i[t];return f},r.parseExpiresIn=function(n){return n=n||"3599",parseInt(n,10)},r.now=function(){return Math.round((new Date).getTime()/1e3)},r.isEmpty=function(n){return void 0===n||!n||0===n.length},r.decodeJwt=function(n){if(this.isEmpty(n))return null;var t=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(n);return!t||t.length<4?null:{header:t[1],JWSPayload:t[2],JWSSig:t[3]}},r.extractIdToken=function(n){var i=this.decodeJwt(n),r,t;if(!i)return null;try{return r=i.JWSPayload,t=this.base64Decode(r),t?JSON.parse(t):null}catch(n){}return null},r.base64Encode=function(n){return btoa(encodeURIComponent(n).replace(/%([0-9A-F]{2})/g,function(n,t){return String.fromCharCode(Number("0x"+t))}))},r.base64Decode=function(n){return decodeURIComponent(atob(n).split("").map(function(n){return"%"+("00"+n.charCodeAt(0).toString(16)).slice(-2)}).join(""))},r.deserialize=function(n){function i(n){return decodeURIComponent(n.replace(f," "))}for(var f=/\+/g,r=/([^&=]+)=([^&]*)/g,u={},t=r.exec(n);t;)u[i(t[1])]=i(t[2]),t=r.exec(n);return u},r.isIntersectingScopes=function(n,t){n=this.convertToLowerCase(n);for(var i=0;i<t.length;i++)if(-1<n.indexOf(t[i].toLowerCase()))return!0;return!1},r.containsScope=function(n,t){return n=this.convertToLowerCase(n),t.every(function(t){return 0<=n.indexOf(t.toString().toLowerCase())})},r.convertToLowerCase=function(n){return n.map(function(n){return n.toLowerCase()})},r.removeElement=function(n,t){return n.filter(function(n){return n!==t})},r.getDefaultRedirectUri=function(){return window.location.href.split("?")[0].split("#")[0]},r.replaceTenantPath=function(n,t){n=n.toLowerCase();var r=this.GetUrlComponents(n),i=r.PathSegments;return!t||0===i.length||i[0]!==u.Constants.common&&i[0]!==u.SSOTypes.ORGANIZATIONS||(i[0]=t),this.constructAuthorityUriFromObject(r,i)},r.constructAuthorityUriFromObject=function(n,t){return this.CanonicalizeUri(n.Protocol+"//"+n.HostNameAndPort+"/"+t.join("/"))},r.GetUrlComponents=function(n){var u,t,i,r;if(!n)throw"Url required";if(u=RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?"),t=n.match(u),!t||t.length<6)throw"Valid url required";return i={Protocol:t[1],HostNameAndPort:t[4],AbsolutePath:t[5]},r=i.AbsolutePath.split("/"),r=r.filter(function(n){return n&&0<n.length}),i.PathSegments=r,i},r.CanonicalizeUri=function(n){return(n=n&&n.toLowerCase())&&!r.endsWith(n,"/")&&(n+="/"),n},r.endsWith=function(n,t){return!(!n||!t)&&-1!==n.indexOf(t,n.length-t.length)},r.urlRemoveQueryStringParameter=function(n,t){if(this.isEmpty(n))return n;var i=new RegExp("(\\&"+t+"=)[^&]+");return n=n.replace(i,""),i=new RegExp("("+t+"=)[^&]+&"),n=n.replace(i,""),i=new RegExp("("+t+"=)[^&]+"),n=n.replace(i,"")},r.getHashFromUrl=function(n){var t=n.indexOf("#"),i=n.indexOf("#/");return-1<i?n.substring(i+2):-1<t?n.substring(t+1):n},r.constructUnifiedCacheQueryParameter=function(n,t){var i,r,e={},f;return n?n.account?(f=n.account,f.sid?(i=u.SSOTypes.SID,r=f.sid):f.userName&&(i=u.SSOTypes.LOGIN_HINT,r=f.userName)):n.sid?(i=u.SSOTypes.SID,r=n.sid):n.loginHint&&(i=u.SSOTypes.LOGIN_HINT,r=n.loginHint):t&&(r=t.hasOwnProperty(u.Constants.upn)?(i=u.SSOTypes.ID_TOKEN,t.upn):(i=u.SSOTypes.ORGANIZATIONS,null)),e=this.addSSOParameter(i,r),n&&n.account&&n.account.homeAccountIdentifier&&(e=this.addSSOParameter(u.SSOTypes.HOMEACCOUNT_ID,n.account.homeAccountIdentifier,e)),e},r.addSSOParameter=function(n,t,i){if(i=i||{},!t)return i;switch(n){case u.SSOTypes.SID:i[u.SSOTypes.SID]=t;break;case u.SSOTypes.ID_TOKEN:i[u.SSOTypes.LOGIN_HINT]=t;i[u.SSOTypes.DOMAIN_HINT]=u.SSOTypes.ORGANIZATIONS;break;case u.SSOTypes.LOGIN_HINT:i[u.SSOTypes.LOGIN_HINT]=t;break;case u.SSOTypes.ORGANIZATIONS:i[u.SSOTypes.DOMAIN_HINT]=u.SSOTypes.ORGANIZATIONS;break;case u.SSOTypes.CONSUMERS:i[u.SSOTypes.DOMAIN_HINT]=u.SSOTypes.CONSUMERS;break;case u.SSOTypes.HOMEACCOUNT_ID:var f=t.split("."),e=r.base64Decode(f[0]),o=r.base64Decode(f[1]);i[u.SSOTypes.LOGIN_REQ]=e;i[u.SSOTypes.DOMAIN_HINT]=(i[u.SSOTypes.DOMAIN_REQ]=o)===u.Constants.consumersUtid?u.SSOTypes.CONSUMERS:u.SSOTypes.ORGANIZATIONS;break;case u.SSOTypes.LOGIN_REQ:i[u.SSOTypes.LOGIN_REQ]=t;break;case u.SSOTypes.DOMAIN_REQ:i[u.SSOTypes.DOMAIN_REQ]=t}return i},r.generateQueryParametersString=function(n){var t=null;return n&&Object.keys(n).forEach(function(i){null==t?t=i+"="+encodeURIComponent(n[i]):t+="&"+i+"="+encodeURIComponent(n[i])}),t},r.isSSOParam=function(n){return n&&(n.account||n.sid||n.loginHint)},r.setResponseIdToken=function(n,t){var i=Number(t.expiration);return i&&!n.expiresOn&&(n.expiresOn=new Date(1e3*i)),f.__assign({},n,{idToken:t,idTokenClaims:t.claims,uniqueId:t.objectId||t.subject,tenantId:t.tenantId})},r);t.Utils=o},function(n,t){
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0
THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.
See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
function u(n){var t="function"==typeof Symbol&&n[Symbol.iterator],i=0;return t?t.call(n):{next:function(){return n&&i>=n.length&&(n=void 0),{value:n&&n[i++],done:!n}}}}function f(n,t){var i="function"==typeof Symbol&&n[Symbol.iterator],r,f,u,e;if(!i)return n;u=i.call(n);e=[];try{for(;(void 0===t||0<t--)&&!(r=u.next()).done;)e.push(r.value)}catch(n){f={error:n}}finally{try{r&&!r.done&&(i=u.return)&&i.call(u)}finally{if(f)throw f.error;}}return e}function i(n){return this instanceof i?(this.v=n,this):new i(n)}Object.defineProperty(t,"__esModule",{value:!0});var r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)};t.__extends=function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)};t.__assign=function(){return t.__assign=Object.assign||function(n){for(var r,i,t=1,u=arguments.length;t<u;t++)for(i in r=arguments[t])Object.prototype.hasOwnProperty.call(r,i)&&(n[i]=r[i]);return n},t.__assign.apply(this,arguments)};t.__rest=function(n,t){var u={},i,r;for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&t.indexOf(i)<0&&(u[i]=n[i]);if(null!=n&&"function"==typeof Object.getOwnPropertySymbols)for(r=0,i=Object.getOwnPropertySymbols(n);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(n,i[r])&&(u[i[r]]=n[i[r]]);return u};t.__decorate=function(n,t,i,r){var f,e=arguments.length,u=e<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r,o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(n,t,i,r);else for(o=n.length-1;0<=o;o--)(f=n[o])&&(u=(e<3?f(u):3<e?f(t,i,u):f(t,i))||u);return 3<e&&u&&Object.defineProperty(t,i,u),u};t.__param=function(n,t){return function(i,r){t(i,r,n)}};t.__metadata=function(n,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(n,t)};t.__awaiter=function(n,t,i,r){return new(i=i||Promise)(function(u,f){function o(n){try{e(r.next(n))}catch(n){f(n)}}function s(n){try{e(r.throw(n))}catch(n){f(n)}}function e(n){n.done?u(n.value):new i(function(t){t(n.value)}).then(o,s)}e((r=r.apply(n,t||[])).next())})};t.__generator=function(n,t){function o(e){return function(o){return function(e){if(f)throw new TypeError("Generator is already executing.");for(;r;)try{if(f=1,u&&(i=2&e[0]?u.return:e[0]?u.throw||((i=u.return)&&i.call(u),0):u.next)&&!(i=i.call(u,e[1])).done)return i;switch(u=0,i&&(e=[2&e[0],i.value]),e[0]){case 0:case 1:i=e;break;case 4:return r.label++,{value:e[1],done:!1};case 5:r.label++;u=e[1];e=[0];continue;case 7:e=r.ops.pop();r.trys.pop();continue;default:if(!(i=0<(i=r.trys).length&&i[i.length-1])&&(6===e[0]||2===e[0])){r=0;continue}if(3===e[0]&&(!i||e[1]>i[0]&&e[1]<i[3])){r.label=e[1];break}if(6===e[0]&&r.label<i[1]){r.label=i[1];i=e;break}if(i&&r.label<i[2]){r.label=i[2];r.ops.push(e);break}i[2]&&r.ops.pop();r.trys.pop();continue}e=t.call(n,r)}catch(o){e=[6,o];u=0}finally{f=i=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,o])}}var f,u,i,e,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return e={next:o(0),"throw":o(1),"return":o(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e};t.__exportStar=function(n,t){for(var i in n)t.hasOwnProperty(i)||(t[i]=n[i])};t.__values=u;t.__read=f;t.__spread=function(){for(var n=[],t=0;t<arguments.length;t++)n=n.concat(f(arguments[t]));return n};t.__spreadArrays=function(){for(var t,i,u=0,n=0,f=arguments.length;n<f;n++)u+=arguments[n].length;for(t=Array(u),i=0,n=0;n<f;n++)for(var e=arguments[n],r=0,o=e.length;r<o;r++,i++)t[i]=e[r];return t};t.__await=i;t.__asyncGenerator=function(n,t,r){function o(n){s[n]&&(f[n]=function(t){return new Promise(function(i,r){1<u.push([n,t,i,r])||e(n,t)})})}function e(n,t){try{!function(n){n.value instanceof i?Promise.resolve(n.value.v).then(c,l):h(u[0][2],n)}(s[n](t))}catch(n){h(u[0][3],n)}}function c(n){e("next",n)}function l(n){e("throw",n)}function h(n,t){n(t);u.shift();u.length&&e(u[0][0],u[0][1])}if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var f,s=r.apply(n,t||[]),u=[];return f={},o("next"),o("throw"),o("return"),f[Symbol.asyncIterator]=function(){return this},f};t.__asyncDelegator=function(n){function r(r,f){t[r]=n[r]?function(t){return(u=!u)?{value:i(n[r](t)),done:"return"===r}:f?f(t):t}:f}var t,u;return t={},r("next"),r("throw",function(n){throw n;}),r("return"),t[Symbol.iterator]=function(){return this},t};t.__asyncValues=function(n){function i(i){t[i]=n[i]&&function(t){return new Promise(function(r,u){(function(n,t,i,r){Promise.resolve(r).then(function(t){n({value:t,done:i})},t)})(r,u,(t=n[i](t)).done,t.value)})}}if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=n[Symbol.asyncIterator];return r?r.call(n):(n=u(n),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t)};t.__makeTemplateObject=function(n,t){return Object.defineProperty?Object.defineProperty(n,"raw",{value:t}):n.raw=t,n};t.__importStar=function(n){var t,i;if(n&&n.__esModule)return n;if(t={},null!=n)for(i in n)Object.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t.default=n,t};t.__importDefault=function(n){return n&&n.__esModule?n:{"default":n}}},function(n,t){function i(){}Object.defineProperty(t,"__esModule",{value:!0});var r=(Object.defineProperty(i,"errorDescription",{get:function(){return"error_description"},enumerable:!0,configurable:!0}),Object.defineProperty(i,"error",{get:function(){return"error"},enumerable:!0,configurable:!0}),Object.defineProperty(i,"scope",{get:function(){return"scope"},enumerable:!0,configurable:!0}),Object.defineProperty(i,"clientInfo",{get:function(){return"client_info"},enumerable:!0,configurable:!0}),Object.defineProperty(i,"clientId",{get:function(){return"clientId"},enumerable:!0,configurable:!0}),Object.defineProperty(i,"idToken",{get:function(){return"id_token"},enumerable:!0,configurable:!0}),Object.defineProperty(i,"adalIdToken",{get:function(){return"adal.idtoken"},enumerable:!0,configurable:!0}),Object.defineProperty(i,"accessToken",{get:function(){return"access_token"},enumerable:!0,configurable:!0}),Object.defineProperty(i,"expiresIn",{get:function(){return"expires_in"},enumerable:!0,configurable:!0}),Object.defineProperty(i,"sessionState",{get:function(){return"session_state"},enumerable:!0,configurable:!0}),Object.defineProperty(i,"claims",{get:function(){return"claims"},enumerable:!0,configurable:!0}),Object.defineProperty(i,"msalClientInfo",{get:function(){return"msal.client.info"},enumerable:!0,configurable:!0}),Object.defineProperty(i,"msalError",{get:function(){return"msal.error"},enumerable:!0,configurable:!0}),Object.defineProperty(i,"msalErrorDescription",{get:function(){return"msal.error.description"},enumerable:!0,configurable:!0}),Object.defineProperty(i,"msalSessionState",{get:function(){return"msal.session.state"},enumerable:!0,configurable:!0}),Object.defineProperty(i,"tokenKeys",{get:function(){return"msal.token.keys"},enumerable:!0,configurable:!0}),Object.defineProperty(i,"accessTokenKey",{get:function(){return"msal.access.token.key"},enumerable:!0,configurable:!0}),Object.defineProperty(i,"expirationKey",{get:function(){return"msal.expiration.key"},enumerable:!0,configurable:!0}),Object.defineProperty(i,"stateLogin",{get:function(){return"msal.state.login"},enumerable:!0,configurable:!0}),Object.defineProperty(i,"stateAcquireToken",{get:function(){return"msal.state.acquireToken"},enumerable:!0,configurable:!0}),Object.defineProperty(i,"stateRenew",{get:function(){return"msal.state.renew"},enumerable:!0,configurable:!0}),Object.defineProperty(i,"nonceIdToken",{get:function(){return"msal.nonce.idtoken"},enumerable:!0,configurable:!0}),Object.defineProperty(i,"userName",{get:function(){return"msal.username"},enumerable:!0,configurable:!0}),Object.defineProperty(i,"idTokenKey",{get:function(){return"msal.idtoken"},enumerable:!0,configurable:!0}),Object.defineProperty(i,"loginRequest",{get:function(){return"msal.login.request"},enumerable:!0,configurable:!0}),Object.defineProperty(i,"loginError",{get:function(){return"msal.login.error"},enumerable:!0,configurable:!0}),Object.defineProperty(i,"renewStatus",{get:function(){return"msal.token.renew.status"},enumerable:!0,configurable:!0}),Object.defineProperty(i,"urlHash",{get:function(){return"msal.urlHash"},enumerable:!0,configurable:!0}),Object.defineProperty(i,"angularLoginRequest",{get:function(){return"msal.angular.login.request"},enumerable:!0,configurable:!0}),Object.defineProperty(i,"msal",{get:function(){return"msal"},enumerable:!0,configurable:!0}),Object.defineProperty(i,"no_account",{get:function(){return"NO_ACCOUNT"},enumerable:!0,configurable:!0}),Object.defineProperty(i,"consumersUtid",{get:function(){return"9188040d-6c67-4c5b-b112-36a304b66dad"},enumerable:!0,configurable:!0}),Object.defineProperty(i,"upn",{get:function(){return"upn"},enumerable:!0,configurable:!0}),Object.defineProperty(i,"prompt_select_account",{get:function(){return"&prompt=select_account"},enumerable:!0,configurable:!0}),Object.defineProperty(i,"prompt_none",{get:function(){return"&prompt=none"},enumerable:!0,configurable:!0}),Object.defineProperty(i,"prompt",{get:function(){return"prompt"},enumerable:!0,configurable:!0}),Object.defineProperty(i,"response_mode_fragment",{get:function(){return"&response_mode=fragment"},enumerable:!0,configurable:!0}),Object.defineProperty(i,"resourceDelimiter",{get:function(){return"|"},enumerable:!0,configurable:!0}),Object.defineProperty(i,"tokenRenewStatusCancelled",{get:function(){return"Canceled"},enumerable:!0,configurable:!0}),Object.defineProperty(i,"tokenRenewStatusCompleted",{get:function(){return"Completed"},enumerable:!0,configurable:!0}),Object.defineProperty(i,"tokenRenewStatusInProgress",{get:function(){return"In Progress"},enumerable:!0,configurable:!0}),Object.defineProperty(i,"popUpWidth",{get:function(){return this._popUpWidth},set:function(n){this._popUpWidth=n},enumerable:!0,configurable:!0}),Object.defineProperty(i,"popUpHeight",{get:function(){return this._popUpHeight},set:function(n){this._popUpHeight=n},enumerable:!0,configurable:!0}),Object.defineProperty(i,"login",{get:function(){return"LOGIN"},enumerable:!0,configurable:!0}),Object.defineProperty(i,"renewToken",{get:function(){return"RENEW_TOKEN"},enumerable:!0,configurable:!0}),Object.defineProperty(i,"unknown",{get:function(){return"UNKNOWN"},enumerable:!0,configurable:!0}),Object.defineProperty(i,"homeAccountIdentifier",{get:function(){return"homeAccountIdentifier"},enumerable:!0,configurable:!0}),Object.defineProperty(i,"common",{get:function(){return"common"},enumerable:!0,configurable:!0}),Object.defineProperty(i,"openidScope",{get:function(){return"openid"},enumerable:!0,configurable:!0}),Object.defineProperty(i,"profileScope",{get:function(){return"profile"},enumerable:!0,configurable:!0}),Object.defineProperty(i,"cacheLocationLocal",{get:function(){return"localStorage"},enumerable:!0,configurable:!0}),Object.defineProperty(i,"cacheLocationSession",{get:function(){return"sessionStorage"},enumerable:!0,configurable:!0}),Object.defineProperty(i,"interactionTypeRedirect",{get:function(){return"redirectInteraction"},enumerable:!0,configurable:!0}),Object.defineProperty(i,"interactionTypePopup",{get:function(){return"popupInteraction"},enumerable:!0,configurable:!0}),i._popUpWidth=483,i._popUpHeight=600,i);t.Constants=r;t.CacheKeys={AUTHORITY:"msal.authority",ACQUIRE_TOKEN_ACCOUNT:"msal.acquireTokenAccount"};t.AADTrustedHostList={"login.windows.net":"login.windows.net","login.chinacloudapi.cn":"login.chinacloudapi.cn","login.cloudgovapi.us":"login.cloudgovapi.us","login.microsoftonline.com":"login.microsoftonline.com","login.microsoftonline.de":"login.microsoftonline.de","login.microsoftonline.us":"login.microsoftonline.us"};t.SSOTypes={ACCOUNT:"account",SID:"sid",LOGIN_HINT:"login_hint",ID_TOKEN:"id_token",DOMAIN_HINT:"domain_hint",ORGANIZATIONS:"organizations",CONSUMERS:"consumers",ACCOUNT_ID:"accountIdentifier",HOMEACCOUNT_ID:"homeAccountIdentifier",LOGIN_REQ:"login_req",DOMAIN_REQ:"domain_req"};t.BlacklistedEQParams=[t.SSOTypes.SID,t.SSOTypes.LOGIN_HINT];t.PromptState={LOGIN:"login",SELECT_ACCOUNT:"select_account",CONSENT:"consent",NONE:"none"};t.Library={version:"1.1.1"}},function(n,t,i){function r(n,t){var i=u.call(this,n,t)||this;return i.name="ClientConfigurationError",Object.setPrototypeOf(i,r.prototype),i}var u,e;Object.defineProperty(t,"__esModule",{value:!0});var o=i(1),f=i(2),s=i(4);t.ClientConfigurationErrorMessage={configurationNotSet:{code:"no_config_set",desc:"Configuration has not been set. Please call the UserAgentApplication constructor with a valid Configuration object."},invalidCacheLocation:{code:"invalid_cache_location",desc:"The cache location provided is not valid."},noStorageSupported:{code:"browser_storage_not_supported",desc:"localStorage and sessionStorage are not supported."},noRedirectCallbacksSet:{code:"no_redirect_callbacks",desc:"No redirect callbacks have been set. Please call setRedirectCallbacks() with the appropriate function arguments before continuing. More information is available here: https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL-basics."},invalidCallbackObject:{code:"invalid_callback_object",desc:"The object passed for the callback was invalid. More information is available here: https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL-basics."},scopesRequired:{code:"scopes_required",desc:"Scopes are required to obtain an access token."},emptyScopes:{code:"empty_input_scopes_error",desc:"Scopes cannot be passed as empty array."},nonArrayScopes:{code:"nonarray_input_scopes_error",desc:"Scopes cannot be passed as non-array."},clientScope:{code:"clientid_input_scopes_error",desc:"Client ID can only be provided as a single scope."},invalidPrompt:{code:"invalid_prompt_value",desc:"Supported prompt values are 'login', 'select_account', 'consent' and 'none'"},invalidAuthorityType:{code:"invalid_authority_type",desc:"The given authority is not a valid type of authority supported by MSAL. Please see here for valid authorities: <insert URL here>."},authorityUriInsecure:{code:"authority_uri_insecure",desc:"Authority URIs must use https."},authorityUriInvalidPath:{code:"authority_uri_invalid_path",desc:"Given authority URI is invalid."},unsupportedAuthorityValidation:{code:"unsupported_authority_validation",desc:"The authority validation is not supported for this authority type."},b2cAuthorityUriInvalidPath:{code:"b2c_authority_uri_invalid_path",desc:"The given URI for the B2C authority is invalid."},claimsRequestParsingError:{code:"claims_request_parsing_error",desc:"Could not parse the given claims request object."},emptyRequestError:{code:"empty_request_error",desc:"Request object is required."},telemetryConfigError:{code:"telemetry_config_error",desc:"Telemetry config is not configured with required values"}};e=(u=s.ClientAuthError,o.__extends(r,u),r.createNoSetConfigurationError=function(){return new r(t.ClientConfigurationErrorMessage.configurationNotSet.code,""+t.ClientConfigurationErrorMessage.configurationNotSet.desc)},r.createInvalidCacheLocationConfigError=function(n){return new r(t.ClientConfigurationErrorMessage.invalidCacheLocation.code,t.ClientConfigurationErrorMessage.invalidCacheLocation.desc+" Provided value: "+n+". Possible values are: "+f.Constants.cacheLocationLocal+", "+f.Constants.cacheLocationSession+".")},r.createNoStorageSupportedError=function(){return new r(t.ClientConfigurationErrorMessage.noStorageSupported.code,t.ClientConfigurationErrorMessage.noStorageSupported.desc)},r.createRedirectCallbacksNotSetError=function(){return new r(t.ClientConfigurationErrorMessage.noRedirectCallbacksSet.code,t.ClientConfigurationErrorMessage.noRedirectCallbacksSet.desc)},r.createInvalidCallbackObjectError=function(n){return new r(t.ClientConfigurationErrorMessage.invalidCallbackObject.code,t.ClientConfigurationErrorMessage.invalidCallbackObject.desc+" Given value for callback function: "+n)},r.createEmptyScopesArrayError=function(n){return new r(t.ClientConfigurationErrorMessage.emptyScopes.code,t.ClientConfigurationErrorMessage.emptyScopes.desc+" Given value: "+n+".")},r.createScopesNonArrayError=function(n){return new r(t.ClientConfigurationErrorMessage.nonArrayScopes.code,t.ClientConfigurationErrorMessage.nonArrayScopes.desc+" Given value: "+n+".")},r.createClientIdSingleScopeError=function(n){return new r(t.ClientConfigurationErrorMessage.clientScope.code,t.ClientConfigurationErrorMessage.clientScope.desc+" Given value: "+n+".")},r.createScopesRequiredError=function(n){return new r(t.ClientConfigurationErrorMessage.scopesRequired.code,t.ClientConfigurationErrorMessage.scopesRequired.desc+" Given value: "+n)},r.createInvalidPromptError=function(n){return new r(t.ClientConfigurationErrorMessage.invalidPrompt.code,t.ClientConfigurationErrorMessage.invalidPrompt.desc+" Given value: "+n)},r.createClaimsRequestParsingError=function(n){return new r(t.ClientConfigurationErrorMessage.claimsRequestParsingError.code,t.ClientConfigurationErrorMessage.claimsRequestParsingError.desc+" Given value: "+n)},r.createEmptyRequestError=function(){var n=t.ClientConfigurationErrorMessage.emptyRequestError;return new r(n.code,n.desc)},r.createTelemetryConfigError=function(n){var i=t.ClientConfigurationErrorMessage.telemetryConfigError,f=i.code,e=i.desc,u={applicationName:"string",applicationVersion:"string",telemetryEmitter:"function"};return new r(f,e+" mising values: "+Object.keys(u).reduce(function(t,i){return n[i]?t:t.concat([i+" ("+u[i]+")"])},[]).join(","))},r);t.ClientConfigurationError=e},function(n,t,i){function r(n,t){var i=u.call(this,n,t)||this;return i.name="ClientAuthError",Object.setPrototypeOf(i,r.prototype),i}var u,e;Object.defineProperty(t,"__esModule",{value:!0});var o=i(1),s=i(5),f=i(0);t.ClientAuthErrorMessage={multipleMatchingTokens:{code:"multiple_matching_tokens",desc:"The cache contains multiple tokens satisfying the requirements. Call AcquireToken again providing more requirements like authority."},multipleCacheAuthorities:{code:"multiple_authorities",desc:"Multiple authorities found in the cache. Pass authority in the API overload."},endpointResolutionError:{code:"endpoints_resolution_error",desc:"Error: could not resolve endpoints. Please check network and try again."},popUpWindowError:{code:"popup_window_error",desc:"Error opening popup window. This can happen if you are using IE or if popups are blocked in the browser."},tokenRenewalError:{code:"token_renewal_error",desc:"Token renewal operation failed due to timeout."},invalidIdToken:{code:"invalid_id_token",desc:"Invalid ID token format."},invalidStateError:{code:"invalid_state_error",desc:"Invalid state."},nonceMismatchError:{code:"nonce_mismatch_error",desc:"Nonce is not matching, Nonce received: "},loginProgressError:{code:"login_progress_error",desc:"Login_In_Progress: Error during login call - login is already in progress."},acquireTokenProgressError:{code:"acquiretoken_progress_error",desc:"AcquireToken_In_Progress: Error during login call - login is already in progress."},userCancelledError:{code:"user_cancelled",desc:"User cancelled the flow."},callbackError:{code:"callback_error",desc:"Error occurred in token received callback function."},userLoginRequiredError:{code:"user_login_error",desc:"User login is required."},userDoesNotExistError:{code:"user_non_existent",desc:"User object does not exist. Please call a login API."},clientInfoDecodingError:{code:"client_info_decoding_error",desc:"The client info could not be parsed/decoded correctly. Please review the trace to determine the root cause."},clientInfoNotPopulatedError:{code:"client_info_not_populated_error",desc:"The service did not populate client_info in the response, Please verify with the service team"},nullOrEmptyIdToken:{code:"null_or_empty_id_token",desc:"The idToken is null or empty. Please review the trace to determine the root cause."},idTokenNotParsed:{code:"id_token_parsing_error",desc:"ID token cannot be parsed. Please review stack trace to determine root cause."},tokenEncodingError:{code:"token_encoding_error",desc:"The token to be decoded is not encoded correctly."},invalidInteractionType:{code:"invalid_interaction_type",desc:"The interaction type passed to the handler was incorrect or unknown"}};e=(u=s.AuthError,o.__extends(r,u),r.createEndpointResolutionError=function(n){var i=t.ClientAuthErrorMessage.endpointResolutionError.desc;return n&&!f.Utils.isEmpty(n)&&(i+=" Details: "+n),new r(t.ClientAuthErrorMessage.endpointResolutionError.code,i)},r.createMultipleMatchingTokensInCacheError=function(n){return new r(t.ClientAuthErrorMessage.multipleMatchingTokens.code,"Cache error for scope "+n+": "+t.ClientAuthErrorMessage.multipleMatchingTokens.desc+".")},r.createMultipleAuthoritiesInCacheError=function(n){return new r(t.ClientAuthErrorMessage.multipleCacheAuthorities.code,"Cache error for scope "+n+": "+t.ClientAuthErrorMessage.multipleCacheAuthorities.desc+".")},r.createPopupWindowError=function(n){var i=t.ClientAuthErrorMessage.popUpWindowError.desc;return n&&!f.Utils.isEmpty(n)&&(i+=" Details: "+n),new r(t.ClientAuthErrorMessage.popUpWindowError.code,i)},r.createTokenRenewalTimeoutError=function(){return new r(t.ClientAuthErrorMessage.tokenRenewalError.code,t.ClientAuthErrorMessage.tokenRenewalError.desc)},r.createInvalidIdTokenError=function(n){return new r(t.ClientAuthErrorMessage.invalidIdToken.code,t.ClientAuthErrorMessage.invalidIdToken.desc+" Given token: "+n)},r.createInvalidStateError=function(n,i){return new r(t.ClientAuthErrorMessage.invalidStateError.code,t.ClientAuthErrorMessage.invalidStateError.desc+" "+n+", state expected : "+i+".")},r.createNonceMismatchError=function(n,i){return new r(t.ClientAuthErrorMessage.nonceMismatchError.code,t.ClientAuthErrorMessage.nonceMismatchError.desc+" "+n+", nonce expected : "+i+".")},r.createLoginInProgressError=function(){return new r(t.ClientAuthErrorMessage.loginProgressError.code,t.ClientAuthErrorMessage.loginProgressError.desc)},r.createAcquireTokenInProgressError=function(){return new r(t.ClientAuthErrorMessage.acquireTokenProgressError.code,t.ClientAuthErrorMessage.acquireTokenProgressError.desc)},r.createUserCancelledError=function(){return new r(t.ClientAuthErrorMessage.userCancelledError.code,t.ClientAuthErrorMessage.userCancelledError.desc)},r.createErrorInCallbackFunction=function(n){return new r(t.ClientAuthErrorMessage.callbackError.code,t.ClientAuthErrorMessage.callbackError.desc+" "+n+".")},r.createUserLoginRequiredError=function(){return new r(t.ClientAuthErrorMessage.userLoginRequiredError.code,t.ClientAuthErrorMessage.userLoginRequiredError.desc)},r.createUserDoesNotExistError=function(){return new r(t.ClientAuthErrorMessage.userDoesNotExistError.code,t.ClientAuthErrorMessage.userDoesNotExistError.desc)},r.createClientInfoDecodingError=function(n){return new r(t.ClientAuthErrorMessage.clientInfoDecodingError.code,t.ClientAuthErrorMessage.clientInfoDecodingError.desc+" Failed with error: "+n)},r.createClientInfoNotPopulatedError=function(n){return new r(t.ClientAuthErrorMessage.clientInfoNotPopulatedError.code,t.ClientAuthErrorMessage.clientInfoNotPopulatedError.desc+" Failed with error: "+n)},r.createIdTokenNullOrEmptyError=function(n){return new r(t.ClientAuthErrorMessage.nullOrEmptyIdToken.code,t.ClientAuthErrorMessage.nullOrEmptyIdToken.desc+" Raw ID Token Value: "+n)},r.createIdTokenParsingError=function(n){return new r(t.ClientAuthErrorMessage.idTokenNotParsed.code,t.ClientAuthErrorMessage.idTokenNotParsed.desc+" Failed with error: "+n)},r.createTokenEncodingError=function(n){return new r(t.ClientAuthErrorMessage.tokenEncodingError.code,t.ClientAuthErrorMessage.tokenEncodingError.desc+" Attempted to decode: "+n)},r.createInvalidInteractionTypeError=function(){return new r(t.ClientAuthErrorMessage.invalidInteractionType.code,t.ClientAuthErrorMessage.invalidInteractionType.desc)},r);t.ClientAuthError=e},function(n,t,i){function r(n,t){var i=u.call(this,t)||this;return Object.setPrototypeOf(i,r.prototype),i.errorCode=n,i.errorMessage=t,i.name="AuthError",i}var f,u,e;Object.defineProperty(t,"__esModule",{value:!0});f=i(1);t.AuthErrorMessage={unexpectedError:{code:"unexpected_error",desc:"Unexpected error in authentication."}};e=(u=Error,f.__extends(r,u),r.createUnexpectedError=function(n){return new r(t.AuthErrorMessage.unexpectedError.code,t.AuthErrorMessage.unexpectedError.desc+": "+n)},r);t.AuthError=e},function(n,t,i){function r(n,t){this.IsValidationEnabled=t;this.CanonicalAuthority=n;this.validateAsUri()}var o;Object.defineProperty(t,"__esModule",{value:!0});var u,e=i(0),f=i(3),s=i(13);(u=t.AuthorityType||(t.AuthorityType={}))[u.Aad=0]="Aad";u[u.Adfs=1]="Adfs";u[u.B2C=2]="B2C";o=(Object.defineProperty(r.prototype,"Tenant",{get:function(){return this.CanonicalAuthorityUrlComponents.PathSegments[0]},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"AuthorizationEndpoint",{get:function(){return this.validateResolved(),this.tenantDiscoveryResponse.AuthorizationEndpoint.replace("{tenant}",this.Tenant)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"EndSessionEndpoint",{get:function(){return this.validateResolved(),this.tenantDiscoveryResponse.EndSessionEndpoint.replace("{tenant}",this.Tenant)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"SelfSignedJwtAudience",{get:function(){return this.validateResolved(),this.tenantDiscoveryResponse.Issuer.replace("{tenant}",this.Tenant)},enumerable:!0,configurable:!0}),r.prototype.validateResolved=function(){if(!this.tenantDiscoveryResponse)throw"Please call ResolveEndpointsAsync first";},Object.defineProperty(r.prototype,"CanonicalAuthority",{get:function(){return this.canonicalAuthority},set:function(n){this.canonicalAuthority=e.Utils.CanonicalizeUri(n);this.canonicalAuthorityUrlComponents=null},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"CanonicalAuthorityUrlComponents",{get:function(){return this.canonicalAuthorityUrlComponents||(this.canonicalAuthorityUrlComponents=e.Utils.GetUrlComponents(this.CanonicalAuthority)),this.canonicalAuthorityUrlComponents},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"DefaultOpenIdConfigurationEndpoint",{get:function(){return this.CanonicalAuthority+"v2.0/.well-known/openid-configuration"},enumerable:!0,configurable:!0}),r.prototype.validateAsUri=function(){var n;try{n=this.CanonicalAuthorityUrlComponents}catch(n){throw f.ClientConfigurationErrorMessage.invalidAuthorityType;}if(!n.Protocol||"https:"!==n.Protocol.toLowerCase())throw f.ClientConfigurationErrorMessage.authorityUriInsecure;if(!n.PathSegments||n.PathSegments.length<1)throw f.ClientConfigurationErrorMessage.authorityUriInvalidPath;},r.prototype.DiscoverEndpoints=function(n){return(new s.XhrClient).sendRequestAsync(n,"GET",!0).then(function(n){return{AuthorizationEndpoint:n.authorization_endpoint,EndSessionEndpoint:n.end_session_endpoint,Issuer:n.issuer}})},r.prototype.resolveEndpointsAsync=function(){var n=this,t="";return this.GetOpenIdConfigurationEndpointAsync().then(function(i){return t=i,n.DiscoverEndpoints(t)}).then(function(t){return n.tenantDiscoveryResponse=t,n})},r);t.Authority=o},function(n,t){Object.defineProperty(t,"__esModule",{value:!0});t.EVENT_NAME_PREFIX="msal.";t.EVENT_NAME_KEY="event_name";t.START_TIME_KEY="start_time";t.ELAPSED_TIME_KEY="elapsed_time";t.TELEMETRY_BLOB_EVENT_NAMES={MsalCorrelationIdConstStrKey:"Microsoft.MSAL.correlation_id",ApiTelemIdConstStrKey:"msal.api_telem_id",ApiIdConstStrKey:"msal.api_id",BrokerAppConstStrKey:"Microsoft_MSAL_broker_app",CacheEventCountConstStrKey:"Microsoft_MSAL_cache_event_count",HttpEventCountTelemetryBatchKey:"Microsoft_MSAL_http_event_count",IdpConstStrKey:"Microsoft_MSAL_idp",IsSilentTelemetryBatchKey:"",IsSuccessfulConstStrKey:"Microsoft_MSAL_is_successful",ResponseTimeConstStrKey:"Microsoft_MSAL_response_time",TenantIdConstStrKey:"Microsoft_MSAL_tenant_id",UiEventCountTelemetryBatchKey:"Microsoft_MSAL_ui_event_count"};t.TENANT_PLACEHOLDER="<tenant>"},function(n,t,i){function u(n,t){void 0===t&&(t={});this.level=r.Info;var i=t.correlationId,e=void 0===i?"":i,u=t.level,o=void 0===u?r.Info:u,f=t.piiLoggingEnabled,s=void 0!==f&&f;this.localCallback=n;this.correlationId=e;this.level=o;this.piiLoggingEnabled=s}var r,f,e,o;Object.defineProperty(t,"__esModule",{value:!0});e=i(0);(f=r=t.LogLevel||(t.LogLevel={}))[f.Error=0]="Error";f[f.Warning=1]="Warning";f[f.Info=2]="Info";f[f.Verbose=3]="Verbose";o=(u.prototype.logMessage=function(n,t,i){if(!(n>this.level||!this.piiLoggingEnabled&&i)){var u,f=(new Date).toUTCString();u=e.Utils.isEmpty(this.correlationId)?f+":"+e.Utils.getLibraryVersion()+"-"+r[n]+" "+t:f+":"+this.correlationId+"-"+e.Utils.getLibraryVersion()+"-"+r[n]+" "+t;this.executeCallback(n,u,i)}},u.prototype.executeCallback=function(n,t,i){this.localCallback&&this.localCallback(n,t,i)},u.prototype.error=function(n){this.logMessage(r.Error,n,!1)},u.prototype.errorPii=function(n){this.logMessage(r.Error,n,!0)},u.prototype.warning=function(n){this.logMessage(r.Warning,n,!1)},u.prototype.warningPii=function(n){this.logMessage(r.Warning,n,!0)},u.prototype.info=function(n){this.logMessage(r.Info,n,!1)},u.prototype.infoPii=function(n){this.logMessage(r.Info,n,!0)},u.prototype.verbose=function(n){this.logMessage(r.Verbose,n,!1)},u.prototype.verbosePii=function(n){this.logMessage(r.Verbose,n,!0)},u.prototype.isPiiLoggingEnabled=function(){return this.piiLoggingEnabled},u);t.Logger=o},function(n,t,i){function r(n,t){var i=u.call(this,n,t)||this;return i.name="ServerError",Object.setPrototypeOf(i,r.prototype),i}var f,e,u,o;Object.defineProperty(t,"__esModule",{value:!0});f=i(1);e=i(5);t.ServerErrorMessage={serverUnavailable:{code:"server_unavailable",desc:"Server is temporarily unavailable."},unknownServerError:{code:"unknown_server_error"}};o=(u=e.AuthError,f.__extends(r,u),r.createServerUnavailableError=function(){return new r(t.ServerErrorMessage.serverUnavailable.code,t.ServerErrorMessage.serverUnavailable.desc)},r.createUnknownServerError=function(n){return new r(t.ServerErrorMessage.unknownServerError.code,n)},r);t.ServerError=o},function(n,t,i){function it(n,t,i){var r=i.value;return i.value=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return this.isInIframe()?new Promise(function(){}):r.apply(this,t)},i}function u(n){this.authResponseCallback=null;this.tokenReceivedCallback=null;this.errorReceivedCallback=null;this.config=rt.buildConfiguration(n);this.redirectCallbacksSet=!1;this.logger=this.config.system.logger;this.clientId=this.config.auth.clientId;this.inCookie=this.config.cache.storeAuthStateInCookie;this.telemetryManager=this.getTelemetryManagerFromConfig(this.config.system.telemetry,this.clientId);this.authority=this.config.auth.authority||"https://login.microsoftonline.com/common";this.loginInProgress=!1;this.acquireTokenInProgress=!1;try{this.cacheStorage=new s.Storage(this.config.cache.cacheLocation)}catch(n){throw o.ClientConfigurationError.createInvalidCacheLocationConfigError(this.config.cache.cacheLocation);}window.openedWindows=[];window.activeRenewals={};window.renewStates=[];window.callbackMappedToRenewStates={};window.promiseMappedToRenewStates={};window.msal=this;var t=window.location.hash,i=this.urlContainsHash(t);this.config.framework.isAngular||i&&this.handleAuthenticationResponse(t)}Object.defineProperty(t,"__esModule",{value:!0});var k=i(1),d=i(24),g=i(25),p=i(26),a=i(27),r=i(2),c=i(28),s=i(29),v=i(11),f=i(0),h=i(31),rt=i(15),ut=i(16),o=i(3),l=i(5),e=i(4),ft=i(9),w=i(17),b=i(18),et=i(32),y="id_token",nt="token",tt="id_token token",ot=(Object.defineProperty(u.prototype,"authority",{get:function(){return this.authorityInstance.CanonicalAuthority},set:function(n){this.authorityInstance=h.AuthorityFactory.CreateInstance(n,this.config.auth.validateAuthority)},enumerable:!0,configurable:!0}),u.prototype.getAuthorityInstance=function(){return this.authorityInstance},u.prototype.handleRedirectCallback=function(n,t){if(!n)throw this.redirectCallbacksSet=!1,o.ClientConfigurationError.createInvalidCallbackObjectError(n);if(t?(this.tokenReceivedCallback=n,this.errorReceivedCallback=t,this.logger.warning("This overload for callback is deprecated - please change the format of the callbacks to a single callback as shown: (err: AuthError, response: AuthResponse).")):this.authResponseCallback=n,this.redirectCallbacksSet=!0,!this.config.framework.isAngular){var i=this.cacheStorage.getItem(r.Constants.urlHash);i&&this.processCallBack(i,null)}},u.prototype.authResponseHandler=function(n,t,i){if(n===r.Constants.interactionTypeRedirect)this.errorReceivedCallback?this.tokenReceivedCallback(t):this.authResponseCallback&&this.authResponseCallback(null,t);else{if(n!==r.Constants.interactionTypePopup)throw e.ClientAuthError.createInvalidInteractionTypeError();i(t)}},u.prototype.authErrorHandler=function(n,t,i,u){if(n===r.Constants.interactionTypeRedirect)this.errorReceivedCallback?this.errorReceivedCallback(t,i.accountState):this.authResponseCallback(t,i);else{if(n!==r.Constants.interactionTypePopup)throw e.ClientAuthError.createInvalidInteractionTypeError();u(t)}},u.prototype.loginRedirect=function(n){if(!this.redirectCallbacksSet)throw o.ClientConfigurationError.createRedirectCallbacksNotSetError();this.acquireTokenInteractive(r.Constants.interactionTypeRedirect,!0,n)},u.prototype.acquireTokenRedirect=function(n){if(!n)throw o.ClientConfigurationError.createEmptyRequestError();if(!this.redirectCallbacksSet)throw o.ClientConfigurationError.createRedirectCallbacksNotSetError();this.acquireTokenInteractive(r.Constants.interactionTypeRedirect,!1,n)},u.prototype.loginPopup=function(n){var t=this;return new Promise(function(i,u){t.acquireTokenInteractive(r.Constants.interactionTypePopup,!0,n,i,u)})},u.prototype.acquireTokenPopup=function(n){var t=this;if(!n)throw o.ClientConfigurationError.createEmptyRequestError();return new Promise(function(i,u){t.acquireTokenInteractive(r.Constants.interactionTypePopup,!1,n,i,u)})},u.prototype.acquireTokenInteractive=function(n,t,i,r,u){var o=this,c,l,s,h,a;if(this.loginInProgress||this.acquireTokenInProgress)c=this.loginInProgress?e.ClientAuthError.createLoginInProgressError():e.ClientAuthError.createAcquireTokenInProgressError(),l=b.buildResponseStateOnly(this.getAccountState(i&&i.state)),this.authErrorHandler(n,c,l,u);else if(s=t?this.appendScopes(i):i.scopes,this.validateInputScope(s,!t),h=i&&i.account&&!t?i.account:this.getAccount(),h||f.Utils.isSSOParam(i))this.acquireTokenHelper(h,n,t,i,s,r,u);else{if(!t)throw this.logger.info("User login is required"),e.ClientAuthError.createUserLoginRequiredError();this.extractADALIdToken()&&!s?(this.logger.info("ADAL's idToken exists. Extracting login information from ADAL's idToken "),a=this.buildIDTokenRequest(i),this.silentLogin=!0,this.acquireTokenSilent(a).then(function(t){o.silentLogin=!1;o.logger.info("Unified cache call is successful");o.authResponseHandler(n,t,r)},function(f){o.silentLogin=!1;o.logger.error("Error occurred during unified cache ATS: "+f);o.acquireTokenHelper(null,n,t,i,s,r,u)})):this.acquireTokenHelper(null,n,t,i,s,r,u)}},u.prototype.acquireTokenHelper=function(n,t,i,u,f,o,s){var c=this,l,a,w,v;i?this.loginInProgress=!0:this.acquireTokenInProgress=!0;w=f?f.join(" ").toLowerCase():this.clientId.toLowerCase();v=!i&&u&&u.authority?h.AuthorityFactory.CreateInstance(u.authority,this.config.auth.validateAuthority):this.authorityInstance;(t!==r.Constants.interactionTypePopup||(a=this.openWindow("about:blank","_blank",1,this,o,s)))&&v.resolveEndpointsAsync().then(function(){var h,k=i?y:c.getTokenType(n,f,!1),b;if(i&&((h=c.cacheStorage.getItem(r.Constants.angularLoginRequest))&&""!==h?c.cacheStorage.setItem(r.Constants.angularLoginRequest,""):h=window.location.href),l=new p.ServerRequestParameters(v,c.clientId,f,k,c.getRedirectUri(),u&&u.state),c.updateCacheEntries(l,n,h),b=(l=c.populateQueryParams(n,u,l)).createNavigateUrl(f)+r.Constants.response_mode_fragment,t===r.Constants.interactionTypeRedirect)i||c.cacheStorage.setItem(r.Constants.stateAcquireToken,l.state,c.inCookie);else{if(t!==r.Constants.interactionTypePopup)throw e.ClientAuthError.createInvalidInteractionTypeError();window.renewStates.push(l.state);window.requestType=i?r.Constants.login:r.Constants.renewToken;c.registerCallback(l.state,w,o,s)}c.navigateWindow(b,a)}).catch(function(n){c.logger.warning("could not resolve endpoints");c.authErrorHandler(t,e.ClientAuthError.createEndpointResolutionError(n.toString),b.buildResponseStateOnly(u.state),s);a&&a.close()})},u.prototype.acquireTokenSilent=function(n){var t=this;if(!n)throw o.ClientConfigurationError.createEmptyRequestError();return new Promise(function(i,u){var b,o,k,l,v,y,w;t.validateInputScope(n.scopes,!0);var c=n.scopes.join(" ").toLowerCase(),s=n.account||t.getAccount(),a=t.cacheStorage.getItem(r.Constants.adalIdToken);if(!s&&!n.sid&&!n.loginHint&&f.Utils.isEmpty(a))return t.logger.info("User login is required"),u(e.ClientAuthError.createUserLoginRequiredError());if(b=t.getTokenType(s,n.scopes,!0),o=new p.ServerRequestParameters(h.AuthorityFactory.CreateInstance(n.authority,t.config.auth.validateAuthority),t.clientId,n.scopes,b,t.getRedirectUri(),n&&n.state),f.Utils.isSSOParam(n)||s?o=t.populateQueryParams(s,n,o):s||f.Utils.isEmpty(a)||(k=f.Utils.extractIdToken(a),t.logger.verbose("ADAL's idToken exists. Extracting login information from ADAL's idToken "),o=t.populateQueryParams(s,null,o,k)),y=n.claimsRequest||o.claimsValue,!y&&!n.forceRefresh)try{v=t.getCachedToken(o,s)}catch(i){l=i}return v?(t.logger.info("Token is already in cache for scope:"+c),i(v),null):l?(t.logger.infoPii(l.errorCode+":"+l.errorMessage),u(l),null):(w=void 0,w=y?"Skipped cache lookup since claims were given.":n.forceRefresh?"Skipped cache lookup since request.forceRefresh option was set to true":"Token is not in cache for scope:"+c,t.logger.verbose(w),o.authorityInstance||(o.authorityInstance=n.authority?h.AuthorityFactory.CreateInstance(n.authority,t.config.auth.validateAuthority):t.authorityInstance),o.authorityInstance.resolveEndpointsAsync().then(function(){window.activeRenewals[c]?(t.logger.verbose("Renew token for scope: "+c+" is in progress. Registering callback"),t.registerCallback(window.activeRenewals[c],c,i,u)):n.scopes&&-1<n.scopes.indexOf(t.clientId)&&1===n.scopes.length?(t.logger.verbose("renewing idToken"),t.renewIdToken(n.scopes,i,u,s,o)):(t.logger.verbose("renewing accesstoken"),t.renewToken(n.scopes,i,u,s,o))}).catch(function(n){return t.logger.warning("could not resolve endpoints"),u(e.ClientAuthError.createEndpointResolutionError(n.toString())),null}))})},u.prototype.openWindow=function(n,t,i,u,f,o){var s,h=this,c;try{s=this.openPopup(n,t,r.Constants.popUpWidth,r.Constants.popUpHeight)}catch(n){return u.loginInProgress=!1,u.acquireTokenInProgress=!1,this.logger.info(e.ClientAuthErrorMessage.popUpWindowError.code+":"+e.ClientAuthErrorMessage.popUpWindowError.desc),this.cacheStorage.setItem(r.Constants.msalError,e.ClientAuthErrorMessage.popUpWindowError.code),this.cacheStorage.setItem(r.Constants.msalErrorDescription,e.ClientAuthErrorMessage.popUpWindowError.desc),o&&o(e.ClientAuthError.createPopupWindowError()),null}return window.openedWindows.push(s),c=window.setInterval(function(){var t,n;if(s&&s.closed&&(u.loginInProgress||u.acquireTokenInProgress)){if(o&&o(e.ClientAuthError.createUserCancelledError()),window.clearInterval(c),h.config.framework.isAngular)return void h.broadcast("msal:popUpClosed",e.ClientAuthErrorMessage.userCancelledError.code+r.Constants.resourceDelimiter+e.ClientAuthErrorMessage.userCancelledError.desc);u.loginInProgress=!1;u.acquireTokenInProgress=!1}try{if(t=s.location,-1!==t.href.indexOf(h.getRedirectUri())&&(window.clearInterval(c),u.loginInProgress=!1,u.acquireTokenInProgress=!1,h.logger.info("Closing popup window"),h.config.framework.isAngular))for(h.broadcast("msal:popUpHashChanged",t.hash),n=0;n<window.openedWindows.length;n++)window.openedWindows[n].close()}catch(t){}},i),s},u.prototype.openPopup=function(n,t,i,r){try{var f=window.screenLeft?window.screenLeft:window.screenX,o=window.screenTop?window.screenTop:window.screenY,s=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,h=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,c=s/2-i/2+f,l=h/2-r/2+o,u=window.open(n,t,"width="+i+", height="+r+", top="+l+", left="+c);if(!u)throw e.ClientAuthError.createPopupWindowError();return u.focus&&u.focus(),u}catch(n){throw this.logger.error("error opening popup "+n.message),this.loginInProgress=!1,this.acquireTokenInProgress=!1,e.ClientAuthError.createPopupWindowError(n.toString());}},u.prototype.isInIframe=function(){return window.parent!==window},u.prototype.parentIsMsal=function(){return window.parent!==window&&window.parent.msal},u.prototype.loadIframeTimeout=function(n,t,i){var f=this,u=window.activeRenewals[i];this.logger.verbose("Set loading state to pending for: "+i+":"+u);this.cacheStorage.setItem(r.Constants.renewStatus+u,r.Constants.tokenRenewStatusInProgress);this.loadFrame(n,t);setTimeout(function(){f.cacheStorage.getItem(r.Constants.renewStatus+u)===r.Constants.tokenRenewStatusInProgress&&(f.logger.verbose("Loading frame has timed out after: "+f.config.system.loadFrameTimeout/1e3+" seconds for scope "+i+":"+u),u&&window.callbackMappedToRenewStates[u]&&window.callbackMappedToRenewStates[u](null,e.ClientAuthError.createTokenRenewalTimeoutError()),f.cacheStorage.setItem(r.Constants.renewStatus+u,r.Constants.tokenRenewStatusCancelled))},this.config.system.loadFrameTimeout)},u.prototype.loadFrame=function(n,t){var i=this,r;this.logger.info("LoadFrame: "+t);r=t;setTimeout(function(){var u=i.addHiddenIFrame(r);""!==u.src&&"about:blank"!==u.src||(u.src=n,i.logger.infoPii("Frame Name : "+t+" Navigated to: "+n))},this.config.system.navigateFrameWait)},u.prototype.addHiddenIFrame=function(n){var i,t;return void 0===n?null:(this.logger.info("Add msal frame to document:"+n),i=document.getElementById(n),i||(document.createElement&&document.documentElement&&-1===window.navigator.userAgent.indexOf("MSIE 5.0")?(t=document.createElement("iframe"),t.setAttribute("id",n),t.style.visibility="hidden",t.style.position="absolute",t.style.width=t.style.height="0",t.style.border="0",i=document.getElementsByTagName("body")[0].appendChild(t)):document.body&&document.body.insertAdjacentHTML&&document.body.insertAdjacentHTML("beforeend","<iframe name='"+n+"' id='"+n+"' style='display:none'><\/iframe>"),window.frames&&window.frames[n]&&(i=window.frames[n])),i)},u.prototype.addHintParameters=function(n,t,i){var u=n||this.getAccount();return u&&!t[r.SSOTypes.SID]&&(!t[r.SSOTypes.LOGIN_HINT]&&u.sid&&i.promptValue===r.PromptState.NONE?t=f.Utils.addSSOParameter(r.SSOTypes.SID,u.sid,t):t[r.SSOTypes.LOGIN_HINT]||!u.userName||f.Utils.isEmpty(u.userName)||(t=f.Utils.addSSOParameter(r.SSOTypes.LOGIN_HINT,u.userName,t)),t[r.SSOTypes.DOMAIN_REQ]||t[r.SSOTypes.LOGIN_REQ]||(t=f.Utils.addSSOParameter(r.SSOTypes.HOMEACCOUNT_ID,u.homeAccountIdentifier,t))),t},u.prototype.navigateWindow=function(n,t){if(!n||f.Utils.isEmpty(n))throw this.logger.info("Navigate url is empty"),l.AuthError.createUnexpectedError("Navigate url is empty");var i=t||window,r=t?"Navigated Popup window to:"+n:"Navigate to:"+n;this.logger.infoPii(r);i.location.replace(n)},u.prototype.registerCallback=function(n,t,i,r){var u=this;window.activeRenewals[t]=n;window.promiseMappedToRenewStates[n]||(window.promiseMappedToRenewStates[n]=[]);window.promiseMappedToRenewStates[n].push({resolve:i,reject:r});window.callbackMappedToRenewStates[n]||(window.callbackMappedToRenewStates[n]=function(i,r){window.activeRenewals[t]=null;for(var f=0;f<window.promiseMappedToRenewStates[n].length;++f)try{if(r)window.promiseMappedToRenewStates[n][f].reject(r);else{if(!i)throw l.AuthError.createUnexpectedError("Error and response are both null");window.promiseMappedToRenewStates[n][f].resolve(i)}}catch(i){u.logger.warning(i)}window.promiseMappedToRenewStates[n]=null;window.callbackMappedToRenewStates[n]=null})},u.prototype.logout=function(){var t=this,n;this.clearCache();this.account=null;n="";this.getPostLogoutRedirectUri()&&(n="post_logout_redirect_uri="+encodeURIComponent(this.getPostLogoutRedirectUri()));this.authorityInstance.resolveEndpointsAsync().then(function(i){var r=i.EndSessionEndpoint?i.EndSessionEndpoint+"?"+n:t.authority+"oauth2/v2.0/logout?"+n;t.navigateWindow(r)})},u.prototype.clearCache=function(){window.renewStates=[];for(var t=this.cacheStorage.getAllAccessTokens(r.Constants.clientId,r.Constants.homeAccountIdentifier),n=0;n<t.length;n++)this.cacheStorage.removeItem(JSON.stringify(t[n].key));this.cacheStorage.resetCacheItems();this.cacheStorage.clearCookie()},u.prototype.clearCacheForScope=function(n){for(var u,i=this.cacheStorage.getAllAccessTokens(r.Constants.clientId,r.Constants.homeAccountIdentifier),t=0;t<i.length;t++)u=i[t],u.value.accessToken===n&&this.cacheStorage.removeItem(JSON.stringify(u.key))},u.prototype.isCallback=function(n){return this.logger.info("isCallback will be deprecated in favor of urlContainsHash in MSAL.js v2.0."),this.urlContainsHash(n)},u.prototype.urlContainsHash=function(n){var t=this.deserializeHash(n);return t.hasOwnProperty(r.Constants.errorDescription)||t.hasOwnProperty(r.Constants.error)||t.hasOwnProperty(r.Constants.accessToken)||t.hasOwnProperty(r.Constants.idToken)},u.prototype.processCallBack=function(n,t,i){var u,f,o;this.logger.info("Processing the callback from redirect response");t=t||this.getResponseState(n);try{u=this.saveTokenFromHash(n,t)}catch(n){f=n}this.cacheStorage.removeItem(r.Constants.urlHash);try{if(this.cacheStorage.clearCookie(),o=this.getAccountState(t.state),u){if(t.requestType===r.Constants.renewToken||u.accessToken?(window.parent!==window?this.logger.verbose("Window is in iframe, acquiring token silently"):this.logger.verbose("acquiring token interactive in progress"),u.tokenType=r.Constants.accessToken):t.requestType===r.Constants.login&&(u.tokenType=r.Constants.idToken),!i)return void this.authResponseHandler(r.Constants.interactionTypeRedirect,u)}else if(!i)return void this.authErrorHandler(r.Constants.interactionTypeRedirect,f,b.buildResponseStateOnly(o));i(u,f)}catch(n){throw this.logger.error("Error occurred in token received callback function: "+n),e.ClientAuthError.createErrorInCallbackFunction(n.toString());}},u.prototype.handleAuthenticationResponse=function(n){var f,u,e;null==n&&(n=window.location.hash);var t=null,o=!1,i=!1;try{i=window.opener&&window.opener.msal&&window.opener.msal!==window.msal}catch(n){i=!1}if(i?(t=window.opener.msal,o=!0):window.parent&&window.parent.msal&&(t=window.parent.msal),f=t.getResponseState(n),u=null,t.logger.info("Returned from redirect url"),this.parentIsMsal())u=window.parent.callbackMappedToRenewStates[f.state];else if(i)u=window.opener.callbackMappedToRenewStates[f.state];else{if(u=null,t.config.auth.navigateToLoginRequestUrl)return t.cacheStorage.setItem(r.Constants.urlHash,n),void(window.parent!==window||o||(window.location.href=t.cacheStorage.getItem(r.Constants.loginRequest,t.inCookie)));if(window.location.hash="",!this.redirectCallbacksSet)return void t.cacheStorage.setItem(r.Constants.urlHash,n)}if(t.processCallBack(n,f,u),i)for(e=0;e<window.opener.openedWindows.length;e++)window.opener.openedWindows[e].close()},u.prototype.deserializeHash=function(n){var t=f.Utils.getHashFromUrl(n);return f.Utils.deserialize(t)},u.prototype.getResponseState=function(n){var t,u=this.deserializeHash(n),f,i;if(!u)throw l.AuthError.createUnexpectedError("Hash was not parsed correctly.");if(!u.hasOwnProperty("state"))throw l.AuthError.createUnexpectedError("Hash does not contain state.");if((t={requestType:r.Constants.unknown,state:u.state,stateMatch:!1}).state===this.cacheStorage.getItem(r.Constants.stateLogin,this.inCookie)||t.state===this.silentAuthenticationState)return t.requestType=r.Constants.login,t.stateMatch=!0,t;if(t.state===this.cacheStorage.getItem(r.Constants.stateAcquireToken,this.inCookie))return t.requestType=r.Constants.renewToken,t.stateMatch=!0,t;if(!t.stateMatch)for(t.requestType=window.requestType,f=window.renewStates,i=0;i<f.length;i++)if(f[i]===t.state){t.stateMatch=!0;break}return t},u.prototype.getCachedToken=function(n,t){var i=null,a=n.scopes,s=this.cacheStorage.getAllAccessTokens(this.clientId,t?t.homeAccountIdentifier:null),u,o,v,y,b,p,d,w,g,k;if(0===s.length)return null;if(u=[],n.authority){for(o=0;o<s.length;o++)y=(v=s[o]).key.scopes.split(" "),f.Utils.containsScope(y,a)&&f.Utils.CanonicalizeUri(v.key.authority)===n.authority&&u.push(v);if(0===u.length)return null;if(1!==u.length)throw e.ClientAuthError.createMultipleMatchingTokensInCacheError(a.toString());i=u[0]}else{for(o=0;o<s.length;o++)y=(v=s[o]).key.scopes.split(" "),f.Utils.containsScope(y,a)&&u.push(v);if(1===u.length)i=u[0],n.authorityInstance=h.AuthorityFactory.CreateInstance(i.key.authority,this.config.auth.validateAuthority);else{if(1<u.length)throw e.ClientAuthError.createMultipleMatchingTokensInCacheError(a.toString());if(b=this.getUniqueAuthority(s,"authority"),1<b.length)throw e.ClientAuthError.createMultipleAuthoritiesInCacheError(a.toString());n.authorityInstance=h.AuthorityFactory.CreateInstance(b[0],this.config.auth.validateAuthority)}}if(null==i)return null;if(p=Number(i.value.expiresIn),d=this.config.system.tokenRenewalOffsetSeconds||300,p&&p>f.Utils.now()+d){if(w=new c.IdToken(i.value.idToken),!t&&!(t=this.getAccount()))throw l.AuthError.createUnexpectedError("Account should not be null here.");return g=this.getAccountState(n.state),k={uniqueId:"",tenantId:"",tokenType:i.value.idToken===i.value.accessToken?r.Constants.idToken:r.Constants.accessToken,idToken:w,idTokenClaims:w.claims,accessToken:i.value.accessToken,scopes:i.key.scopes.split(" "),expiresOn:new Date(1e3*p),account:t,accountState:g},f.Utils.setResponseIdToken(k,w),k}return this.cacheStorage.removeItem(JSON.stringify(u[0].key)),null},u.prototype.getUniqueAuthority=function(n,t){var i=[],r=[];return n.forEach(function(n){n.key.hasOwnProperty(t)&&-1===r.indexOf(n.key[t])&&(r.push(n.key[t]),i.push(n.key[t]))}),i},u.prototype.extractADALIdToken=function(){var n=this.cacheStorage.getItem(r.Constants.adalIdToken);return f.Utils.isEmpty(n)?null:f.Utils.extractIdToken(n)},u.prototype.renewToken=function(n,t,i,u,e){var o=n.join(" ").toLowerCase(),h,s;this.logger.verbose("renewToken is called for scope:"+o);h=this.addHiddenIFrame("msalRenewFrame"+o);this.updateCacheEntries(e,u);this.logger.verbose("Renew token Expected state: "+e.state);s=f.Utils.urlRemoveQueryStringParameter(e.createNavigateUrl(n),r.Constants.prompt)+r.Constants.prompt_none;window.renewStates.push(e.state);window.requestType=r.Constants.renewToken;this.registerCallback(e.state,o,t,i);this.logger.infoPii("Navigate to:"+s);h.src="about:blank";this.loadIframeTimeout(s,"msalRenewFrame"+o,o)},u.prototype.renewIdToken=function(n,t,i,u,e){var s,o;this.logger.info("renewidToken is called");s=this.addHiddenIFrame("msalIdTokenFrame");this.updateCacheEntries(e,u);this.logger.verbose("Renew Idtoken Expected state: "+e.state);o=f.Utils.urlRemoveQueryStringParameter(e.createNavigateUrl(n),r.Constants.prompt)+r.Constants.prompt_none;this.silentLogin?(window.requestType=r.Constants.login,this.silentAuthenticationState=e.state):(window.requestType=r.Constants.renewToken,window.renewStates.push(e.state));this.registerCallback(e.state,this.clientId,t,i);this.logger.infoPii("Navigate to:"+o);s.src="about:blank";this.loadIframeTimeout(o,"msalIdTokenFrame",this.clientId)},u.prototype.saveAccessToken=function(n,t,i,u,e){var h,o,s=k.__assign({},n),c=new a.ClientInfo(u),l,nt,tt,v,y;if(i.hasOwnProperty("scope")){for(var w=(h=i.scope).split(" "),b=this.cacheStorage.getAllAccessTokens(this.clientId,t),p=0;p<b.length;p++)l=b[p],l.key.homeAccountIdentifier===n.account.homeAccountIdentifier&&(nt=l.key.scopes.split(" "),f.Utils.isIntersectingScopes(nt,w)&&this.cacheStorage.removeItem(JSON.stringify(l.key)));tt=f.Utils.parseExpiresIn(i[r.Constants.expiresIn]);o=f.Utils.now()+tt;v=new d.AccessTokenKey(t,this.clientId,h,c.uid,c.utid);y=new g.AccessTokenValue(i[r.Constants.accessToken],e.rawIdToken,o.toString(),u);this.cacheStorage.setItem(JSON.stringify(v),JSON.stringify(y));s.accessToken=i[r.Constants.accessToken];s.scopes=w}else h=this.clientId,v=new d.AccessTokenKey(t,this.clientId,h,c.uid,c.utid),o=Number(e.expiration),y=new g.AccessTokenValue(i[r.Constants.idToken],i[r.Constants.idToken],o.toString(),u),this.cacheStorage.setItem(JSON.stringify(v),JSON.stringify(y)),s.scopes=[h],s.accessToken=i[r.Constants.idToken];return o?s.expiresOn=new Date(1e3*o):this.logger.error("Could not parse expiresIn parameter"),s},u.prototype.saveTokenFromHash=function(n,t){var d,g,rt,ut,p,et,h,nt,it;this.logger.info("State status:"+t.stateMatch+"; Request type:"+t.requestType);this.cacheStorage.setItem(r.Constants.msalError,"");this.cacheStorage.setItem(r.Constants.msalErrorDescription,"");var y,u={uniqueId:"",tenantId:"",tokenType:"",idToken:null,idTokenClaims:null,accessToken:null,scopes:[],expiresOn:null,account:null,accountState:""},i=this.deserializeHash(n),b="",k="",o=null;if(i.hasOwnProperty(r.Constants.errorDescription)||i.hasOwnProperty(r.Constants.error))(this.logger.infoPii("Error :"+i[r.Constants.error]+"; Error description:"+i[r.Constants.errorDescription]),this.cacheStorage.setItem(r.Constants.msalError,i[r.Constants.error]),this.cacheStorage.setItem(r.Constants.msalErrorDescription,i[r.Constants.errorDescription]),t.requestType===r.Constants.login&&(this.loginInProgress=!1,this.cacheStorage.setItem(r.Constants.loginError,i[r.Constants.errorDescription]+":"+i[r.Constants.error]),b=s.Storage.generateAuthorityKey(t.state)),t.requestType===r.Constants.renewToken)&&(this.acquireTokenInProgress=!1,b=s.Storage.generateAuthorityKey(t.state),d=this.getAccount(),g=void 0,g=d&&!f.Utils.isEmpty(d.homeAccountIdentifier)?d.homeAccountIdentifier:r.Constants.no_account,k=s.Storage.generateAcquireTokenAccountKey(g,t.state)),rt=i[r.Constants.error],ut=i[r.Constants.errorDescription],y=w.InteractionRequiredAuthError.isInteractionRequiredError(rt)||w.InteractionRequiredAuthError.isInteractionRequiredError(ut)?new w.InteractionRequiredAuthError(i[r.Constants.error],i[r.Constants.errorDescription]):new ft.ServerError(i[r.Constants.error],i[r.Constants.errorDescription]);else if(t.stateMatch){if(this.logger.info("State is right"),i.hasOwnProperty(r.Constants.sessionState)&&this.cacheStorage.setItem(r.Constants.msalSessionState,i[r.Constants.sessionState]),u.accountState=this.getAccountState(t.state),p="",i.hasOwnProperty(r.Constants.accessToken)){if(this.logger.info("Fragment has access token"),this.acquireTokenInProgress=!1,i.hasOwnProperty(r.Constants.idToken)?(o=new c.IdToken(i[r.Constants.idToken]),u.idToken=o,u.idTokenClaims=o.claims):(o=new c.IdToken(this.cacheStorage.getItem(r.Constants.idTokenKey)),u=f.Utils.setResponseIdToken(u,o)),et=s.Storage.generateAuthorityKey(t.state),h=this.cacheStorage.getItem(et,this.inCookie),f.Utils.isEmpty(h)||(h=f.Utils.replaceTenantPath(h,u.tenantId)),!i.hasOwnProperty(r.Constants.clientInfo))throw this.logger.warning("ClientInfo not received in the response from AAD"),e.ClientAuthError.createClientInfoNotPopulatedError("ClientInfo not received in the response from the server");p=i[r.Constants.clientInfo];u.account=v.Account.createAccount(o,new a.ClientInfo(p));nt=void 0;nt=u.account&&!f.Utils.isEmpty(u.account.homeAccountIdentifier)?u.account.homeAccountIdentifier:r.Constants.no_account;k=s.Storage.generateAcquireTokenAccountKey(nt,t.state);var st=s.Storage.generateAcquireTokenAccountKey(r.Constants.no_account,t.state),ot=this.cacheStorage.getItem(k),tt=void 0;f.Utils.isEmpty(ot)?f.Utils.isEmpty(this.cacheStorage.getItem(st))||(u=this.saveAccessToken(u,h,i,p,o)):(tt=JSON.parse(ot),u.account&&tt&&f.Utils.compareAccounts(u.account,tt)?(u=this.saveAccessToken(u,h,i,p,o),this.logger.info("The user object received in the response is the same as the one passed in the acquireToken request")):this.logger.warning("The account object created from the response is not the same as the one passed in the acquireToken request"))}i.hasOwnProperty(r.Constants.idToken)&&(this.logger.info("Fragment has id token"),this.loginInProgress=!1,o=new c.IdToken(i[r.Constants.idToken]),u=f.Utils.setResponseIdToken(u,o),i.hasOwnProperty(r.Constants.clientInfo)?p=i[r.Constants.clientInfo]:this.logger.warning("ClientInfo not received in the response from AAD"),b=s.Storage.generateAuthorityKey(t.state),h=this.cacheStorage.getItem(b,this.inCookie),f.Utils.isEmpty(h)||(h=f.Utils.replaceTenantPath(h,o.tenantId)),this.account=v.Account.createAccount(o,new a.ClientInfo(p)),u.account=this.account,o&&o.nonce?o.nonce!==this.cacheStorage.getItem(r.Constants.nonceIdToken,this.inCookie)?(this.account=null,this.cacheStorage.setItem(r.Constants.loginError,"Nonce Mismatch. Expected Nonce: "+this.cacheStorage.getItem(r.Constants.nonceIdToken,this.inCookie)+",Actual Nonce: "+o.nonce),this.logger.error("Nonce Mismatch.Expected Nonce: "+this.cacheStorage.getItem(r.Constants.nonceIdToken,this.inCookie)+",Actual Nonce: "+o.nonce),y=e.ClientAuthError.createNonceMismatchError(this.cacheStorage.getItem(r.Constants.nonceIdToken,this.inCookie),o.nonce)):(this.cacheStorage.setItem(r.Constants.idTokenKey,i[r.Constants.idToken]),this.cacheStorage.setItem(r.Constants.msalClientInfo,p),this.saveAccessToken(u,h,i,p,o)):(b=t.state,k=t.state,this.logger.error("Invalid id_token received in the response"),y=e.ClientAuthError.createInvalidIdTokenError(o),this.cacheStorage.setItem(r.Constants.msalError,y.errorCode),this.cacheStorage.setItem(r.Constants.msalErrorDescription,y.errorMessage)))}else b=t.state,k=t.state,it=this.cacheStorage.getItem(r.Constants.stateLogin,this.inCookie),this.logger.error("State Mismatch.Expected State: "+it+",Actual State: "+t.state),y=e.ClientAuthError.createInvalidStateError(t.state,it),this.cacheStorage.setItem(r.Constants.msalError,y.errorCode),this.cacheStorage.setItem(r.Constants.msalErrorDescription,y.errorMessage);if(this.cacheStorage.setItem(r.Constants.renewStatus+t.state,r.Constants.tokenRenewStatusCompleted),this.cacheStorage.removeAcquireTokenEntries(t.state),this.inCookie&&(this.cacheStorage.setItemCookie(b,"",-1),this.cacheStorage.clearCookie()),y)throw y;if(!u)throw l.AuthError.createUnexpectedError("Response is null");return u},u.prototype.getAccount=function(){var n,t,i,u;return this.account?this.account:(n=this.cacheStorage.getItem(r.Constants.idTokenKey),t=this.cacheStorage.getItem(r.Constants.msalClientInfo),f.Utils.isEmpty(n)||f.Utils.isEmpty(t))?null:(i=new c.IdToken(n),u=new a.ClientInfo(t),this.account=v.Account.createAccount(i,u),this.account)},u.prototype.getAccountState=function(n){if(n){var t=n.indexOf("|");if(-1<t&&t+1<n.length)return n.substring(t+1)}return n},u.prototype.getAllAccounts=function(){for(var i=[],t=this.cacheStorage.getAllAccessTokens(r.Constants.clientId,r.Constants.homeAccountIdentifier),n=0;n<t.length;n++){var u=new c.IdToken(t[n].value.idToken),f=new a.ClientInfo(t[n].value.homeAccountIdentifier),e=v.Account.createAccount(u,f);i.push(e)}return this.getUniqueAccounts(i)},u.prototype.getUniqueAccounts=function(n){if(!n||n.length<=1)return n;for(var i=[],r=[],t=0;t<n.length;++t)n[t].homeAccountIdentifier&&-1===i.indexOf(n[t].homeAccountIdentifier)&&(i.push(n[t].homeAccountIdentifier),r.push(n[t]));return r},u.prototype.validateInputScope=function(n,t){if(n){if(!Array.isArray(n))throw o.ClientConfigurationError.createScopesNonArrayError(n);if(n.length<1)throw o.ClientConfigurationError.createEmptyScopesArrayError(n.toString());if(-1<n.indexOf(this.clientId)&&1<n.length)throw o.ClientConfigurationError.createClientIdSingleScopeError(n.toString());}else if(t)throw o.ClientConfigurationError.createScopesRequiredError(n);},u.prototype.getScopeFromState=function(n){if(n){var t=n.indexOf("|");if(-1<t&&t+1<n.length)return n.substring(t+1)}return""},u.prototype.appendScopes=function(n){var t;return n&&n.scopes&&(t=n.extraScopesToConsent?n.scopes.concat(n.extraScopesToConsent):n.scopes),t},u.prototype.broadcast=function(n,t){var i=new CustomEvent(n,{detail:t});window.dispatchEvent(i)},u.prototype.getCachedTokenInternal=function(n,t,i){var r=t||this.getAccount();if(!r)return null;var u=this.authorityInstance?this.authorityInstance:h.AuthorityFactory.CreateInstance(this.authority,this.config.auth.validateAuthority),f=this.getTokenType(r,n,!0),e=new p.ServerRequestParameters(u,this.clientId,n,f,this.getRedirectUri(),i);return this.getCachedToken(e,t)},u.prototype.getScopesForEndpoint=function(n){var t,i,r,u;if(0<this.config.framework.unprotectedResources.length)for(t=0;t<this.config.framework.unprotectedResources.length;t++)if(-1<n.indexOf(this.config.framework.unprotectedResources[t]))return null;if(0<this.config.framework.protectedResourceMap.size)for(i=0,r=Array.from(this.config.framework.protectedResourceMap.keys());i<r.length;i++)if(u=r[i],-1<n.indexOf(u))return this.config.framework.protectedResourceMap.get(u);return-1<n.indexOf("http://")||-1<n.indexOf("https://")?this.getHostFromUri(n)===this.getHostFromUri(this.getRedirectUri())?new Array(this.clientId):null:new Array(this.clientId)},u.prototype.getLoginInProgress=function(){return!!this.cacheStorage.getItem(r.Constants.urlHash)||this.loginInProgress},u.prototype.setloginInProgress=function(n){this.loginInProgress=n},u.prototype.getAcquireTokenInProgress=function(){return this.acquireTokenInProgress},u.prototype.setAcquireTokenInProgress=function(n){this.acquireTokenInProgress=n},u.prototype.getLogger=function(){return this.config.system.logger},u.prototype.getRedirectUri=function(){return"function"==typeof this.config.auth.redirectUri?this.config.auth.redirectUri():this.config.auth.redirectUri},u.prototype.getPostLogoutRedirectUri=function(){return"function"==typeof this.config.auth.postLogoutRedirectUri?this.config.auth.postLogoutRedirectUri():this.config.auth.postLogoutRedirectUri},u.prototype.getCurrentConfiguration=function(){if(!this.config)throw o.ClientConfigurationError.createNoSetConfigurationError();return this.config},u.prototype.getHostFromUri=function(n){var t=String(n).replace(/^(https?:)\/\//,"");return t.split("/")[0]},u.prototype.getTokenType=function(n,t,i){return i?f.Utils.compareAccounts(n,this.getAccount())?-1<t.indexOf(this.config.auth.clientId)?y:nt:-1<t.indexOf(this.config.auth.clientId)?y:tt:f.Utils.compareAccounts(n,this.getAccount())?-1<t.indexOf(this.clientId)?y:nt:tt},u.prototype.setAccountCache=function(n,t){var i=n?this.getAccountId(n):r.Constants.no_account,u=s.Storage.generateAcquireTokenAccountKey(i,t);this.cacheStorage.setItem(u,JSON.stringify(n))},u.prototype.setAuthorityCache=function(n,t){var i=s.Storage.generateAuthorityKey(n);this.cacheStorage.setItem(i,f.Utils.CanonicalizeUri(t),this.inCookie)},u.prototype.updateCacheEntries=function(n,t,i){i?(this.cacheStorage.setItem(r.Constants.loginRequest,i,this.inCookie),this.cacheStorage.setItem(r.Constants.loginError,""),this.cacheStorage.setItem(r.Constants.stateLogin,n.state,this.inCookie),this.cacheStorage.setItem(r.Constants.msalError,""),this.cacheStorage.setItem(r.Constants.msalErrorDescription,"")):this.setAccountCache(t,n.state);this.setAuthorityCache(n.state,n.authority);this.cacheStorage.setItem(r.Constants.nonceIdToken,n.nonce,this.inCookie)},u.prototype.getAccountId=function(n){return f.Utils.isEmpty(n.homeAccountIdentifier)?r.Constants.no_account:n.homeAccountIdentifier},u.prototype.buildIDTokenRequest=function(n){return{scopes:[this.clientId],authority:this.authority,account:this.getAccount(),extraQueryParameters:n.extraQueryParameters}},u.prototype.populateQueryParams=function(n,t,i,r){var e,u={};return t&&(t.prompt&&(this.validatePromptParameter(t.prompt),i.promptValue=t.prompt),t.claimsRequest&&(ut.validateClaimsRequest(t),i.claimsValue=t.claimsRequest),f.Utils.isSSOParam(t)&&(u=f.Utils.constructUnifiedCacheQueryParameter(t,null))),r&&(u=f.Utils.constructUnifiedCacheQueryParameter(null,r)),this.logger.verbose("Calling addHint parameters"),u=this.addHintParameters(n,u,i),t&&(e=this.sanitizeEQParams(t)),i.queryParameters=f.Utils.generateQueryParametersString(u),i.extraQueryParameters=f.Utils.generateQueryParametersString(e),i},u.prototype.validatePromptParameter=function(n){if(!(0<=[r.PromptState.LOGIN,r.PromptState.SELECT_ACCOUNT,r.PromptState.CONSENT,r.PromptState.NONE].indexOf(n)))throw o.ClientConfigurationError.createInvalidPromptError(n);},u.prototype.sanitizeEQParams=function(n){var i=this,t=n.extraQueryParameters;return t?(n.claimsRequest&&(this.logger.warning("Removed duplicate claims from extraQueryParameters. Please use either the claimsRequest field OR pass as extraQueryParameter - not both."),delete t[r.Constants.claims]),r.BlacklistedEQParams.forEach(function(n){t[n]&&(i.logger.warning("Removed duplicate "+n+" from extraQueryParameters. Please use the "+n+" field in request object."),delete t[n])}),t):null},u.prototype.getTelemetryManagerFromConfig=function(n,t){var e;if(!n)return null;var i=n.applicationName,r=n.applicationVersion,u=n.telemetryEmitter;if(!i||!r||!u)throw o.ClientConfigurationError.createTelemetryConfigError(n);return e={platform:{sdk:"msal.js",sdkVersion:f.Utils.getLibraryVersion(),applicationName:i,applicationVersion:r},clientId:t},new et.default(e,u)},k.__decorate([it],u.prototype,"acquireTokenSilent",null),u);t.UserAgentApplication=ot},function(n,t,i){function u(n,t,i,r,u,f,e){this.accountIdentifier=n;this.homeAccountIdentifier=t;this.userName=i;this.name=r;this.idToken=u;this.idTokenClaims=u;this.sid=f;this.environment=e}Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),f=(u.createAccount=function(n,t){var i,o=n.objectId||n.subject,f=t?t.uid:"",e=t?t.utid:"";return r.Utils.isEmpty(f)||r.Utils.isEmpty(e)||(i=r.Utils.base64Encode(f)+"."+r.Utils.base64Encode(e)),new u(o,i,n.preferredName,n.name,n.claims,n.sid,n.issuer)},u);t.Account=f},function(n,t,i){function r(n,t){return u.call(this,n,t)||this}Object.defineProperty(t,"__esModule",{value:!0});var u,e=i(1),f=i(6),o=i(13),s=i(2),h=(u=f.Authority,e.__extends(r,u),Object.defineProperty(r.prototype,"AadInstanceDiscoveryEndpointUrl",{get:function(){return r.AadInstanceDiscoveryEndpoint+"?api-version=1.0&authorization_endpoint="+this.CanonicalAuthority+"oauth2/v2.0/authorize"},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"AuthorityType",{get:function(){return f.AuthorityType.Aad},enumerable:!0,configurable:!0}),r.prototype.GetOpenIdConfigurationEndpointAsync=function(){var i=this,n=new Promise(function(n){return n(i.DefaultOpenIdConfigurationEndpoint)}),t;return this.IsValidationEnabled?(t=this.CanonicalAuthorityUrlComponents.HostNameAndPort,this.IsInTrustedHostList(t)?n:(new o.XhrClient).sendRequestAsync(this.AadInstanceDiscoveryEndpointUrl,"GET",!0).then(function(n){return n.tenant_discovery_endpoint})):n},r.prototype.IsInTrustedHostList=function(n){return s.AADTrustedHostList[n.toLowerCase()]},r.AadInstanceDiscoveryEndpoint="https://login.microsoftonline.com/common/discovery/instance",r);t.AadAuthority=h},function(n,t){function i(){}Object.defineProperty(t,"__esModule",{value:!0});var r=(i.prototype.sendRequestAsync=function(n,t){var i=this;return new Promise(function(r,u){var f=new XMLHttpRequest;if(f.open(t,n,!0),f.onload=function(){(f.status<200||300<=f.status)&&u(i.handleError(f.responseText));try{var n=JSON.parse(f.responseText)}catch(e){u(i.handleError(f.responseText))}r(n)},f.onerror=function(){u(f.status)},"GET"!==t)throw"not implemented";f.send()})},i.prototype.handleError=function(n){var t;try{if((t=JSON.parse(n)).error)return t.error;throw n;}catch(t){return n}},i);t.XhrClient=r},function(n,t,i){function r(n,t){var r=u.call(this,n,t)||this,e=h.Utils.GetUrlComponents(n),i=e.PathSegments;if(i.length<3)throw f.ClientConfigurationErrorMessage.b2cAuthorityUriInvalidPath;return r.CanonicalAuthority="https://"+e.HostNameAndPort+"/"+i[0]+"/"+i[1]+"/"+i[2]+"/",r}Object.defineProperty(t,"__esModule",{value:!0});var u,e=i(1),o=i(12),s=i(6),f=i(3),h=i(0),c=(u=o.AadAuthority,e.__extends(r,u),Object.defineProperty(r.prototype,"AuthorityType",{get:function(){return s.AuthorityType.B2C},enumerable:!0,configurable:!0}),r.prototype.GetOpenIdConfigurationEndpointAsync=function(){var t=this,n=new Promise(function(n){return n(t.DefaultOpenIdConfigurationEndpoint)});return this.IsValidationEnabled?this.IsInTrustedHostList(this.CanonicalAuthorityUrlComponents.HostNameAndPort)?n:new Promise(function(n,t){return t(f.ClientConfigurationErrorMessage.unsupportedAuthorityValidation)}):n},r.B2C_PREFIX="tfp",r);t.B2cAuthority=c},function(n,t,i){Object.defineProperty(t,"__esModule",{value:!0});var r=i(1),f=i(8),u=i(0),e={clientId:"",authority:null,validateAuthority:!0,redirectUri:function(){return u.Utils.getDefaultRedirectUri()},postLogoutRedirectUri:function(){return u.Utils.getDefaultRedirectUri()},navigateToLoginRequestUrl:!0},o={cacheLocation:"sessionStorage",storeAuthStateInCookie:!1},s={logger:new f.Logger(null),loadFrameTimeout:6e3,tokenRenewalOffsetSeconds:300,navigateFrameWait:500},h={isAngular:!1,unprotectedResources:[],protectedResourceMap:new Map};t.buildConfiguration=function(n){var f=n.auth,t=n.cache,c=void 0===t?{}:t,i=n.system,l=void 0===i?{}:i,u=n.framework,a=void 0===u?{}:u;return{auth:r.__assign({},e,f),cache:r.__assign({},o,c),system:r.__assign({},s,l),framework:r.__assign({},h,a)}}},function(n,t,i){Object.defineProperty(t,"__esModule",{value:!0});var r=i(3);t.validateClaimsRequest=function(n){if(n.claimsRequest)try{JSON.parse(n.claimsRequest)}catch(n){throw r.ClientConfigurationError.createClaimsRequestParsingError(n);}}},function(n,t,i){function r(n,t){var i=u.call(this,n,t)||this;return i.name="InteractionRequiredAuthError",Object.setPrototypeOf(i,r.prototype),i}var f,e,u,o;Object.defineProperty(t,"__esModule",{value:!0});f=i(1);e=i(9);t.InteractionRequiredAuthErrorMessage={interactionRequired:{code:"interaction_required"},consentRequired:{code:"consent_required"},loginRequired:{code:"login_required"}};o=(u=e.ServerError,f.__extends(r,u),r.isInteractionRequiredError=function(n){var i=[t.InteractionRequiredAuthErrorMessage.interactionRequired.code,t.InteractionRequiredAuthErrorMessage.consentRequired.code,t.InteractionRequiredAuthErrorMessage.loginRequired.code];return n&&-1<i.indexOf(n)},r.createLoginRequiredAuthError=function(n){return new r(t.InteractionRequiredAuthErrorMessage.loginRequired.code,n)},r.createInteractionRequiredAuthError=function(n){return new r(t.InteractionRequiredAuthErrorMessage.interactionRequired.code,n)},r.createConsentRequiredAuthError=function(n){return new r(t.InteractionRequiredAuthErrorMessage.consentRequired.code,n)},r);t.InteractionRequiredAuthError=o},function(n,t){Object.defineProperty(t,"__esModule",{value:!0});t.buildResponseStateOnly=function(n){return{uniqueId:"",tenantId:"",tokenType:"",idToken:null,idTokenClaims:null,accessToken:"",scopes:null,expiresOn:null,account:null,accountState:n}}},function(n){var r="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto),t,i;r?(t=new Uint8Array(16),n.exports=function(){return r(t),t}):(i=new Array(16),n.exports=function(){for(var t,n=0;n<16;n++)0==(3&n)&&(t=4294967296*Math.random()),i[n]=t>>>((3&n)<<3)&255;return i})},function(n){for(var i=[],t=0;t<256;++t)i[t]=(t+256).toString(16).substr(1);n.exports=function(n,t){var r=t||0,u=i;return[u[n[r++]],u[n[r++]],u[n[r++]],u[n[r++]],"-",u[n[r++]],u[n[r++]],"-",u[n[r++]],u[n[r++]],"-",u[n[r++]],u[n[r++]],"-",u[n[r++]],u[n[r++]],u[n[r++]],u[n[r++]],u[n[r++]],u[n[r++]]].join("")}},function(n,t,i){Object.defineProperty(t,"__esModule",{value:!0});var f=i(14),e=i(2),r=i(7),u=i(0);t.scrubTenantFromUri=function(n){var i=u.Utils.GetUrlComponents(n),t,o;return e.AADTrustedHostList[i.HostNameAndPort.toLocaleLowerCase()]?(t=i.PathSegments,t&&2<=t.length&&(o=t[1]===f.B2cAuthority.B2C_PREFIX?2:1,o<t.length&&(t[o]=r.TENANT_PLACEHOLDER)),i.Protocol+"//"+i.HostNameAndPort+"/"+t.join("/")):null};t.hashPersonalIdentifier=function(n){return u.Utils.base64Encode(n)};t.prependEventNamePrefix=function(n){return""+r.EVENT_NAME_PREFIX+(n||"")}},function(n,t,i){n.exports=i(23)},function(n,t,i){var u,f,e,o,s,h,c,r,l,a,v,y,p,w,b;Object.defineProperty(t,"__esModule",{value:!0});u=i(10);t.UserAgentApplication=u.UserAgentApplication;f=i(8);t.Logger=f.Logger;e=i(8);t.LogLevel=e.LogLevel;o=i(11);t.Account=o.Account;s=i(2);t.Constants=s.Constants;h=i(6);t.Authority=h.Authority;c=i(10);t.CacheResult=c.CacheResult;r=i(15);t.CacheLocation=r.CacheLocation;t.Configuration=r.Configuration;l=i(16);t.AuthenticationParameters=l.AuthenticationParameters;a=i(18);t.AuthResponse=a.AuthResponse;v=i(5);t.AuthError=v.AuthError;y=i(4);t.ClientAuthError=y.ClientAuthError;p=i(9);t.ServerError=p.ServerError;w=i(3);t.ClientConfigurationError=w.ClientConfigurationError;b=i(17);t.InteractionRequiredAuthError=b.InteractionRequiredAuthError},function(n,t,i){function u(n,t,i,u,f){this.authority=r.Utils.CanonicalizeUri(n);this.clientId=t;this.scopes=i;this.homeAccountIdentifier=r.Utils.base64Encode(u)+"."+r.Utils.base64Encode(f)}Object.defineProperty(t,"__esModule",{value:!0});var r=i(0);t.AccessTokenKey=u},function(n,t){function i(n,t,i,r){this.accessToken=n;this.idToken=t;this.expiresIn=i;this.homeAccountIdentifier=r}Object.defineProperty(t,"__esModule",{value:!0});t.AccessTokenValue=i},function(n,t,i){function u(n,t,i,u,f,e){this.authorityInstance=n;this.clientId=t;this.scopes=i;this.nonce=r.Utils.createNewGuid();this.state=e&&!r.Utils.isEmpty(e)?r.Utils.createNewGuid()+"|"+e:r.Utils.createNewGuid();this.correlationId=r.Utils.createNewGuid();this.xClientSku="MSAL.JS";this.xClientVer=r.Utils.getLibraryVersion();this.responseType=u;this.redirectUri=f}Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),f=(Object.defineProperty(u.prototype,"authority",{get:function(){return this.authorityInstance?this.authorityInstance.CanonicalAuthority:null},enumerable:!0,configurable:!0}),u.prototype.createNavigateUrl=function(n){var i=this.createNavigationUrlString(n),t=this.authorityInstance.AuthorizationEndpoint;return t+=t.indexOf("?")<0?"?":"&",""+t+i.join("&")},u.prototype.createNavigationUrlString=function(n){-1===(n=n||[this.clientId]).indexOf(this.clientId)&&n.push(this.clientId);var t=[];return t.push("response_type="+this.responseType),this.translateclientIdUsedInScope(n),t.push("scope="+encodeURIComponent(this.parseScope(n))),t.push("client_id="+encodeURIComponent(this.clientId)),t.push("redirect_uri="+encodeURIComponent(this.redirectUri)),t.push("state="+encodeURIComponent(this.state)),t.push("nonce="+encodeURIComponent(this.nonce)),t.push("client_info=1"),t.push("x-client-SKU="+this.xClientSku),t.push("x-client-Ver="+this.xClientVer),this.promptValue&&t.push("prompt="+encodeURIComponent(this.promptValue)),this.claimsValue&&t.push("claims="+encodeURIComponent(this.claimsValue)),this.queryParameters&&t.push(this.queryParameters),this.extraQueryParameters&&t.push(this.extraQueryParameters),t.push("client-request-id="+encodeURIComponent(this.correlationId)),t},u.prototype.translateclientIdUsedInScope=function(n){var t=n.indexOf(this.clientId);0<=t&&(n.splice(t,1),-1===n.indexOf("openid")&&n.push("openid"),-1===n.indexOf("profile")&&n.push("profile"))},u.prototype.parseScope=function(n){var i="",t;if(n)for(t=0;t<n.length;++t)i+=t!==n.length-1?n[t]+" ":n[t];return i},u);t.ServerRequestParameters=f},function(n,t,i){function r(n){if(!n||u.Utils.isEmpty(n))return this.uid="",void(this.utid="");try{var i=u.Utils.base64Decode(n),t=JSON.parse(i);t&&(t.hasOwnProperty("uid")&&(this.uid=t.uid),t.hasOwnProperty("utid")&&(this.utid=t.utid))}catch(n){throw f.ClientAuthError.createClientInfoDecodingError(n);}}Object.defineProperty(t,"__esModule",{value:!0});var u=i(0),f=i(4),e=(Object.defineProperty(r.prototype,"uid",{get:function(){return this._uid?this._uid:""},set:function(n){this._uid=n},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"utid",{get:function(){return this._utid?this._utid:""},set:function(n){this._utid=n},enumerable:!0,configurable:!0}),r);t.ClientInfo=e},function(n,t,i){function f(n){if(r.Utils.isEmpty(n))throw u.ClientAuthError.createIdTokenNullOrEmptyError(n);try{this.rawIdToken=n;this.claims=r.Utils.extractIdToken(n);this.claims&&(this.claims.hasOwnProperty("iss")&&(this.issuer=this.claims.iss),this.claims.hasOwnProperty("oid")&&(this.objectId=this.claims.oid),this.claims.hasOwnProperty("sub")&&(this.subject=this.claims.sub),this.claims.hasOwnProperty("tid")&&(this.tenantId=this.claims.tid),this.claims.hasOwnProperty("ver")&&(this.version=this.claims.ver),this.claims.hasOwnProperty("preferred_username")&&(this.preferredName=this.claims.preferred_username),this.claims.hasOwnProperty("name")&&(this.name=this.claims.name),this.claims.hasOwnProperty("nonce")&&(this.nonce=this.claims.nonce),this.claims.hasOwnProperty("exp")&&(this.expiration=this.claims.exp),this.claims.hasOwnProperty("home_oid")&&(this.homeObjectId=this.claims.home_oid),this.claims.hasOwnProperty("sid")&&(this.sid=this.claims.sid))}catch(n){throw u.ClientAuthError.createIdTokenParsingError(n);}}Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),u=i(4);t.IdToken=f},function(n,t,i){function r(n){if(r.instance)return r.instance;if(this.cacheLocation=n,this.localStorageSupported=void 0!==window[this.cacheLocation]&&null!=window[this.cacheLocation],this.sessionStorageSupported=void 0!==window[n]&&null!=window[n],!(r.instance=this).localStorageSupported&&!this.sessionStorageSupported)throw o.ClientConfigurationError.createNoStorageSupportedError();return r.instance}Object.defineProperty(t,"__esModule",{value:!0});var u=i(2),e=i(30),f=i(2),o=i(3),s=(r.prototype.setItem=function(n,t,i){window[this.cacheLocation]&&window[this.cacheLocation].setItem(n,t);i&&this.setItemCookie(n,t)},r.prototype.getItem=function(n,t){return t&&this.getItemCookie(n)?this.getItemCookie(n):window[this.cacheLocation]?window[this.cacheLocation].getItem(n):null},r.prototype.removeItem=function(n){if(window[this.cacheLocation])return window[this.cacheLocation].removeItem(n)},r.prototype.clear=function(){if(window[this.cacheLocation])return window[this.cacheLocation].clear()},r.prototype.getAllAccessTokens=function(n,t){var f,o=[],r=window[this.cacheLocation],i,u;if(r){i=void 0;for(i in r)r.hasOwnProperty(i)&&i.match(n)&&i.match(t)&&(u=this.getItem(i),u&&(f=new e.AccessTokenCacheItem(JSON.parse(i),JSON.parse(u)),o.push(f)))}return o},r.prototype.removeAcquireTokenEntries=function(n){var r=window[this.cacheLocation],t,e,i;if(r){t=void 0;for(t in r)!r.hasOwnProperty(t)||-1===t.indexOf(f.CacheKeys.AUTHORITY)&&1===t.indexOf(f.CacheKeys.ACQUIRE_TOKEN_ACCOUNT)||n&&-1===t.indexOf(n)||(e=t.split(u.Constants.resourceDelimiter),i=void 0,1<e.length&&(i=e[1]),i&&!this.tokenRenewalInProgress(i)&&(this.removeItem(t),this.removeItem(u.Constants.renewStatus+i),this.removeItem(u.Constants.stateLogin),this.removeItem(u.Constants.stateAcquireToken),this.setItemCookie(t,"",-1)))}this.clearCookie()},r.prototype.tokenRenewalInProgress=function(n){var t=window[this.cacheLocation][u.Constants.renewStatus+n];return!(!t||t!==u.Constants.tokenRenewStatusInProgress)},r.prototype.resetCacheItems=function(){var t=window[this.cacheLocation],n;if(t){n=void 0;for(n in t)t.hasOwnProperty(n)&&-1!==n.indexOf(u.Constants.msal)&&this.removeItem(n);this.removeAcquireTokenEntries()}},r.prototype.setItemCookie=function(n,t,i){var r=n+"="+t+";";i&&(r+="expires="+this.getCookieExpirationTime(i)+";");document.cookie=r},r.prototype.getItemCookie=function(n){for(var t,r=n+"=",u=document.cookie.split(";"),i=0;i<u.length;i++){for(t=u[i];" "===t.charAt(0);)t=t.substring(1);if(0===t.indexOf(r))return t.substring(r.length,t.length)}return""},r.prototype.getCookieExpirationTime=function(n){var t=new Date;return new Date(t.getTime()+864e5*n).toUTCString()},r.prototype.clearCookie=function(){this.setItemCookie(u.Constants.nonceIdToken,"",-1);this.setItemCookie(u.Constants.stateLogin,"",-1);this.setItemCookie(u.Constants.loginRequest,"",-1);this.setItemCookie(u.Constants.stateAcquireToken,"",-1)},r.generateAcquireTokenAccountKey=function(n,t){return f.CacheKeys.ACQUIRE_TOKEN_ACCOUNT+u.Constants.resourceDelimiter+""+n+u.Constants.resourceDelimiter+t},r.generateAuthorityKey=function(n){return f.CacheKeys.AUTHORITY+u.Constants.resourceDelimiter+""+n},r);t.Storage=s},function(n,t){function i(n,t){this.key=n;this.value=t}Object.defineProperty(t,"__esModule",{value:!0});t.AccessTokenCacheItem=i},function(n,t,i){function u(){}Object.defineProperty(t,"__esModule",{value:!0});var f=i(0),e=i(12),o=i(14),r=i(6),s=i(3),h=(u.DetectAuthorityFromUrl=function(n){switch(n=f.Utils.CanonicalizeUri(n),f.Utils.GetUrlComponents(n).PathSegments[0]){case"tfp":return r.AuthorityType.B2C;case"adfs":return r.AuthorityType.Adfs;default:return r.AuthorityType.Aad}},u.CreateInstance=function(n,t){if(f.Utils.isEmpty(n))return null;switch(u.DetectAuthorityFromUrl(n)){case r.AuthorityType.B2C:return new o.B2cAuthority(n,t);case r.AuthorityType.Aad:return new e.AadAuthority(n,t);default:throw s.ClientConfigurationErrorMessage.invalidAuthorityType;}},u);t.AuthorityFactory=h},function(n,t,i){function u(n){return n.telemetryCorrelationId+"-"+n.eventId+"-"+n.eventName}function r(n,t){this.completedEvents={};this.inProgressEvents={};this.eventCountByCorrelationId={};this.onlySendFailureTelemetry=!1;this.telemetryPlatform=n.platform;this.clientId=n.clientId;this.onlySendFailureTelemetry=n.onlySendFailureTelemetry;this.telemetryEmitter=t}Object.defineProperty(t,"__esModule",{value:!0});var f=i(33),e=(r.prototype.startEvent=function(n){if(this.telemetryEmitter){var t=u(n);this.inProgressEvents[t]=n}},r.prototype.stopEvent=function(n){var t=u(n),i;this.telemetryEmitter&&this.inProgressEvents[t]&&(n.stop(),this.incrementEventCount(n),i=this.completedEvents[n.telemetryCorrelationId],this.completedEvents[n.telemetryCorrelationId]=(i||[]).concat([n]),delete this.inProgressEvents[t])},r.prototype.flush=function(n){var o=this,i,t,r,u,e;this.telemetryEmitter&&this.completedEvents[n]&&(i=this.getOrphanedEvents(n),i.forEach(function(n){return o.incrementEventCount(n)}),t=this.completedEvents[n].concat(i),delete this.completedEvents[n],r=this.eventCountByCorrelationId[n],(delete this.eventCountByCorrelationId[n],t&&t.length)&&(u=new f.default(this.telemetryPlatform,n,this.clientId,r),e=t.concat([u]),this.telemetryEmitter(e.map(function(n){return n.get()}))))},r.prototype.incrementEventCount=function(n){var r,t=n.eventName,i=this.eventCountByCorrelationId[n.telemetryCorrelationId];i?i[t]=i[t]?i[t]+1:1:this.eventCountByCorrelationId[n.telemetryCorrelationId]=((r={})[t]=1,r)},r.prototype.getOrphanedEvents=function(n){var t=this;return Object.keys(this.inProgressEvents).reduce(function(i,r){if(-1===r.indexOf(n))return i;var u=t.inProgressEvents[r];return delete t.inProgressEvents[r],i.concat([u])},[])},r);t.default=e},function(n,t,i){function e(n,t,i,e){var o=u.call(this,r.prependEventNamePrefix("default_event"),t)||this;return o.event[r.prependEventNamePrefix("client_id")]=i,o.event[r.prependEventNamePrefix("sdk_plaform")]=n.sdk,o.event[r.prependEventNamePrefix("sdk_version")]=n.sdkVersion,o.event[r.prependEventNamePrefix("application_name")]=n.applicationName,o.event[r.prependEventNamePrefix("application_version")]=n.applicationVersion,o.event[""+f.TELEMETRY_BLOB_EVENT_NAMES.UiEventCountTelemetryBatchKey]=o.getEventCount(r.prependEventNamePrefix("ui_event"),e),o.event[""+f.TELEMETRY_BLOB_EVENT_NAMES.HttpEventCountTelemetryBatchKey]=o.getEventCount(r.prependEventNamePrefix("http_event"),e),o.event[""+f.TELEMETRY_BLOB_EVENT_NAMES.CacheEventCountConstStrKey]=o.getEventCount(r.prependEventNamePrefix("cache_event"),e),o}Object.defineProperty(t,"__esModule",{value:!0});var u,o=i(1),f=i(7),s=i(34),r=i(21),h=(u=s.default,o.__extends(e,u),e.prototype.getEventCount=function(n,t){return t[n]?t[n]:0},e);t.default=h},function(n,t,i){function r(n,t){var i;this.startTimestamp=Date.now();this.eventId=s.v4();this.event=((i={})[f.prependEventNamePrefix(u.EVENT_NAME_KEY)]=n,i[f.prependEventNamePrefix(u.START_TIME_KEY)]=this.startTimestamp,i[f.prependEventNamePrefix(u.ELAPSED_TIME_KEY)]=-1,i[""+e.TELEMETRY_BLOB_EVENT_NAMES.MsalCorrelationIdConstStrKey]=t,i)}Object.defineProperty(t,"__esModule",{value:!0});var o=i(1),s=i(35),e=i(7),u=i(7),f=i(21),h=(r.prototype.setElapsedTime=function(n){this.event[f.prependEventNamePrefix(u.ELAPSED_TIME_KEY)]=n},r.prototype.stop=function(){this.setElapsedTime(+Date.now()-+this.startTimestamp)},Object.defineProperty(r.prototype,"telemetryCorrelationId",{get:function(){return this.event[""+e.TELEMETRY_BLOB_EVENT_NAMES.MsalCorrelationIdConstStrKey]},set:function(n){this.event[""+e.TELEMETRY_BLOB_EVENT_NAMES.MsalCorrelationIdConstStrKey]=n},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"eventName",{get:function(){return this.event[f.prependEventNamePrefix(u.EVENT_NAME_KEY)]},enumerable:!0,configurable:!0}),r.prototype.get=function(){return o.__assign({},this.event,{eventId:this.eventId})},r);t.default=h},function(n,t,i){var f=i(36),u=i(37),r=u;r.v1=f;r.v4=u;n.exports=r},function(n,t,i){var e,r,o=i(19),s=i(20),u=0,f=0;n.exports=function(n,t,i){var c=t&&i||0,h=t||[],b=(n=n||{}).node||e,a=void 0!==n.clockseq?n.clockseq:r,l,y,p,w;(null==b||null==a)&&(l=o(),null==b&&(b=e=[1|l[0],l[1],l[2],l[3],l[4],l[5]]),null==a&&(a=r=16383&(l[6]<<8|l[7])));var v=void 0!==n.msecs?n.msecs:(new Date).getTime(),k=void 0!==n.nsecs?n.nsecs:f+1,d=v-u+(k-f)/1e4;if(d<0&&void 0===n.clockseq&&(a=a+1&16383),(d<0||u<v)&&void 0===n.nsecs&&(k=0),1e4<=k)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");for(u=v,r=a,y=(1e4*(268435455&(v+=122192928e5))+(f=k))%4294967296,h[c++]=y>>>24&255,h[c++]=y>>>16&255,h[c++]=y>>>8&255,h[c++]=255&y,p=v/4294967296*1e4&268435455,h[c++]=p>>>8&255,h[c++]=255&p,h[c++]=p>>>24&15|16,h[c++]=p>>>16&255,h[c++]=a>>>8|128,h[c++]=255&a,w=0;w<6;++w)h[c+w]=b[w];return t||s(h)}},function(n,t,i){var r=i(19),u=i(20);n.exports=function(n,t,i){var o=t&&i||0,f,e;if("string"==typeof n&&(t="binary"===n?new Array(16):null,n=null),f=(n=n||{}).random||(n.rng||r)(),f[6]=15&f[6]|64,f[8]=63&f[8]|128,t)for(e=0;e<16;++e)t[o+e]=f[e];return t||u(f)}}],n.c=t,n.d=function(t,i,r){n.o(t,i)||Object.defineProperty(t,i,{enumerable:!0,get:r})},n.r=function(n){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"});Object.defineProperty(n,"__esModule",{value:!0})},n.t=function(t,i){var r,u;if((1&i&&(t=n(t)),8&i)||4&i&&"object"==typeof t&&t&&t.__esModule)return t;if(r=Object.create(null),n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&i&&"string"!=typeof t)for(u in t)n.d(r,u,function(n){return t[n]}.bind(null,u));return r},n.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(i,"a",i),i},n.o=function(n,t){return Object.prototype.hasOwnProperty.call(n,t)},n.p="",n(n.s=22);var i,t});