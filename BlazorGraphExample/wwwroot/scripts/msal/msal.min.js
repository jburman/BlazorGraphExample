/*! msal v0.1.7 2018-06-15 */
!function(n,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("Msal",[],t):"object"==typeof exports?exports.Msal=t():n.Msal=t()}("undefined"!=typeof self?self:this,function(){return function(n){function t(r){if(i[r])return i[r].exports;var u=i[r]={i:r,l:!1,exports:{}};return n[r].call(u.exports,u,u.exports,t),u.l=!0,u.exports}var i={};return t.m=n,t.c=i,t.d=function(n,i,r){t.o(n,i)||Object.defineProperty(n,i,{configurable:!1,enumerable:!0,get:r})},t.n=function(n){var i=n&&n.__esModule?function(){return n.default}:function(){return n};return t.d(i,"a",i),i},t.o=function(n,t){return Object.prototype.hasOwnProperty.call(n,t)},t.p="",t(t.s=10)}([function(n,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function n(){}return n.compareObjects=function(n,t){return!(!n||!t)&&!(!n.userIdentifier||!t.userIdentifier||n.userIdentifier!==t.userIdentifier)},n.expiresIn=function(n){return n||(n="3599"),this.now()+parseInt(n,10)},n.now=function(){return Math.round((new Date).getTime()/1e3)},n.isEmpty=function(n){return void 0===n||!n||0===n.length},n.extractIdToken=function(n){var i=this.decodeJwt(n),r,t;if(!i)return null;try{return r=i.JWSPayload,t=this.base64DecodeStringUrlSafe(r),t?JSON.parse(t):null}catch(n){}return null},n.base64EncodeStringUrlSafe=function(n){return window.btoa?window.btoa(n):this.encode(n)},n.base64DecodeStringUrlSafe=function(n){return n=n.replace(/-/g,"+").replace(/_/g,"/"),window.atob?decodeURIComponent(encodeURIComponent(window.atob(n))):decodeURIComponent(encodeURIComponent(this.decode(n)))},n.encode=function(n){var e,t,i,h,c,o,r,u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",s="",f=0;for(n=this.utf8Encode(n);f<n.length;)e=n.charCodeAt(f++),t=n.charCodeAt(f++),i=n.charCodeAt(f++),h=e>>2,c=(3&e)<<4|t>>4,o=(15&t)<<2|i>>6,r=63&i,isNaN(t)?o=r=64:isNaN(i)&&(r=64),s=s+u.charAt(h)+u.charAt(c)+u.charAt(o)+u.charAt(r);return s.replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")},n.utf8Encode=function(n){var i,r,t;for(n=n.replace(/\r\n/g,"\n"),i="",r=0;r<n.length;r++)t=n.charCodeAt(r),t<128?i+=String.fromCharCode(t):t>127&&t<2048?(i+=String.fromCharCode(t>>6|192),i+=String.fromCharCode(63&t|128)):(i+=String.fromCharCode(t>>12|224),i+=String.fromCharCode(t>>6&63|128),i+=String.fromCharCode(63&t|128));return i},n.decode=function(n){var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",u,o,s,c,l,t,r,h,a,f,i;if(n=String(n).replace(/=+$/,""),u=n.length,u%4==1)throw new Error("The token to be decoded is not correctly encoded.");for(f="",i=0;i<u;i+=4){if(o=e.indexOf(n.charAt(i)),s=e.indexOf(n.charAt(i+1)),c=e.indexOf(n.charAt(i+2)),l=e.indexOf(n.charAt(i+3)),i+2===u-1){t=o<<18|s<<12|c<<6;r=t>>16&255;h=t>>8&255;f+=String.fromCharCode(r,h);break}if(i+1===u-1){t=o<<18|s<<12;r=t>>16&255;f+=String.fromCharCode(r);break}t=o<<18|s<<12|c<<6|l;r=t>>16&255;h=t>>8&255;a=255&t;f+=String.fromCharCode(r,h,a)}return f},n.decodeJwt=function(n){if(this.isEmpty(n))return null;var t=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(n);return!t||t.length<4?null:{header:t[1],JWSPayload:t[2],JWSSig:t[3]}},n.deserialize=function(n){for(var f=/\+/g,i=/([^&=]+)=([^&]*)/g,r=function(n){return decodeURIComponent(n.replace(f," "))},u={},t=i.exec(n);t;)u[r(t[1])]=r(t[2]),t=i.exec(n);return u},n.isIntersectingScopes=function(n,t){n=this.convertToLowerCase(n);for(var i=0;i<t.length;i++)if(n.indexOf(t[i].toLowerCase())>-1)return!0;return!1},n.containsScope=function(n,t){return n=this.convertToLowerCase(n),t.every(function(t){return n.indexOf(t.toString().toLowerCase())>=0})},n.convertToLowerCase=function(n){return n.map(function(n){return n.toLowerCase()})},n.removeElement=function(n,t){return n.filter(function(n){return n!==t})},n.decimalToHex=function(n){for(var t=n.toString(16);t.length<2;)t="0"+t;return t},n.getLibraryVersion=function(){return"0.1.7"},n.replaceFirstPath=function(t,i){if(t.match(/^(https?\:)\/\/(([^:\/?#] *)(?:\:([0-9]+))?)([\/]{0,1}[^?#] *)(\?[^#] *|)(#. *|)$/)){var u=n.GetUrlComponents(t),r=u.PathSegments;r.shift();(r[0]&&"common"===r[0]||"organizations"===r[0])&&(r[0]=i,t=u.Protocol+"//"+u.HostNameAndPort+"/"+r.join("/"))}return t},n.createNewGuid=function(){var e=window.crypto,t;if(e&&e.getRandomValues)return t=new Uint8Array(16),e.getRandomValues(t),t[6]|=64,t[6]&=79,t[8]|=128,t[8]&=191,n.decimalToHex(t[0])+n.decimalToHex(t[1])+n.decimalToHex(t[2])+n.decimalToHex(t[3])+"-"+n.decimalToHex(t[4])+n.decimalToHex(t[5])+"-"+n.decimalToHex(t[6])+n.decimalToHex(t[7])+"-"+n.decimalToHex(t[8])+n.decimalToHex(t[9])+"-"+n.decimalToHex(t[10])+n.decimalToHex(t[11])+n.decimalToHex(t[12])+n.decimalToHex(t[13])+n.decimalToHex(t[14])+n.decimalToHex(t[15]);for(var r="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx",o="0123456789abcdef",u=0,f="",i=0;i<36;i++)"-"!==r[i]&&"4"!==r[i]&&(u=16*Math.random()|0),"x"===r[i]?f+=o[u]:"y"===r[i]?(u&=3,u|=8,f+=o[u]):f+=r[i];return f},n.GetUrlComponents=function(n){var u,t,i,r;if(!n)throw"Url required";if(u=RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?"),t=n.match(u),!t||t.length<6)throw"Valid url required";return i={Protocol:t[1],HostNameAndPort:t[4],AbsolutePath:t[5]},r=i.AbsolutePath.split("/"),r=r.filter(function(n){return n&&n.length>0}),i.PathSegments=r,i},n.CanonicalizeUri=function(t){return t&&(t=t.toLowerCase()),t&&!n.endsWith(t,"/")&&(t+="/"),t},n.endsWith=function(n,t){return!(!n||!t)&&-1!==n.indexOf(t,n.length-t.length)},n}();t.Utils=i},function(n,t,i){"use strict";var f;Object.defineProperty(t,"__esModule",{value:!0});var u=i(0),r=i(5),e=i(9);!function(n){n[n.Aad=0]="Aad";n[n.Adfs=1]="Adfs";n[n.B2C=2]="B2C"}(t.AuthorityType||(t.AuthorityType={}));f=function(){function n(n,t){this.IsValidationEnabled=t;this.CanonicalAuthority=n;this.validateAsUri()}return Object.defineProperty(n.prototype,"Tenant",{get:function(){return this.CanonicalAuthorityUrlComponents.PathSegments[0]},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"AuthorizationEndpoint",{get:function(){return this.validateResolved(),this.tenantDiscoveryResponse.AuthorizationEndpoint.replace("{tenant}",this.Tenant)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"EndSessionEndpoint",{get:function(){return this.validateResolved(),this.tenantDiscoveryResponse.EndSessionEndpoint.replace("{tenant}",this.Tenant)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"SelfSignedJwtAudience",{get:function(){return this.validateResolved(),this.tenantDiscoveryResponse.Issuer.replace("{tenant}",this.Tenant)},enumerable:!0,configurable:!0}),n.prototype.validateResolved=function(){if(!this.tenantDiscoveryResponse)throw"Please call ResolveEndpointsAsync first";},Object.defineProperty(n.prototype,"CanonicalAuthority",{get:function(){return this.canonicalAuthority},set:function(n){this.canonicalAuthority=u.Utils.CanonicalizeUri(n);this.canonicalAuthorityUrlComponents=null},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"CanonicalAuthorityUrlComponents",{get:function(){return this.canonicalAuthorityUrlComponents||(this.canonicalAuthorityUrlComponents=u.Utils.GetUrlComponents(this.CanonicalAuthority)),this.canonicalAuthorityUrlComponents},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"DefaultOpenIdConfigurationEndpoint",{get:function(){return this.CanonicalAuthority+"v2.0/.well-known/openid-configuration"},enumerable:!0,configurable:!0}),n.prototype.validateAsUri=function(){var n;try{n=this.CanonicalAuthorityUrlComponents}catch(n){throw r.ErrorMessage.invalidAuthorityType;}if(!n.Protocol||"https:"!==n.Protocol.toLowerCase())throw r.ErrorMessage.authorityUriInsecure;if(!n.PathSegments||n.PathSegments.length<1)throw r.ErrorMessage.authorityUriInvalidPath;},n.prototype.DiscoverEndpoints=function(n){return(new e.XhrClient).sendRequestAsync(n,"GET",!0).then(function(n){return{AuthorizationEndpoint:n.authorization_endpoint,EndSessionEndpoint:n.end_session_endpoint,Issuer:n.issuer}})},n.prototype.ResolveEndpointsAsync=function(){var n=this,t="";return this.GetOpenIdConfigurationEndpointAsync().then(function(i){return t=i,n.DiscoverEndpoints(t)}).then(function(t){return n.tenantDiscoveryResponse=t,n})},n}();t.Authority=f},function(n,t,i){"use strict";function e(n,t){function i(){this.constructor=n}nt(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}function o(n,t){var u={},r;for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&t.indexOf(i)<0&&(u[i]=n[i]);if(null!=n&&"function"==typeof Object.getOwnPropertySymbols)for(r=0,i=Object.getOwnPropertySymbols(n);r<i.length;r++)t.indexOf(i[r])<0&&(u[i[r]]=n[i[r]]);return u}function s(n,t,i,r){var f,e=arguments.length,u=e<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r,o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(n,t,i,r);else for(o=n.length-1;o>=0;o--)(f=n[o])&&(u=(e<3?f(u):e>3?f(t,i,u):f(t,i))||u);return e>3&&u&&Object.defineProperty(t,i,u),u}function h(n,t){return function(i,r){t(i,r,n)}}function c(n,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(n,t)}function l(n,t,i,r){return new(i||(i=Promise))(function(u,f){function o(n){try{e(r.next(n))}catch(n){f(n)}}function s(n){try{e(r.throw(n))}catch(n){f(n)}}function e(n){n.done?u(n.value):new i(function(t){t(n.value)}).then(o,s)}e((r=r.apply(n,t||[])).next())})}function a(n,t){function f(n){return function(t){return s([n,t])}}function s(f){if(e)throw new TypeError("Generator is already executing.");for(;r;)try{if(e=1,u&&(i=2&f[0]?u.return:f[0]?u.throw||((i=u.return)&&i.call(u),0):u.next)&&!(i=i.call(u,f[1])).done)return i;switch(u=0,i&&(f=[2&f[0],i.value]),f[0]){case 0:case 1:i=f;break;case 4:return r.label++,{value:f[1],done:!1};case 5:r.label++;u=f[1];f=[0];continue;case 7:f=r.ops.pop();r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(6===f[0]||2===f[0])){r=0;continue}if(3===f[0]&&(!i||f[1]>i[0]&&f[1]<i[3])){r.label=f[1];break}if(6===f[0]&&r.label<i[1]){r.label=i[1];i=f;break}if(i&&r.label<i[2]){r.label=i[2];r.ops.push(f);break}i[2]&&r.ops.pop();r.trys.pop();continue}f=t.call(n,r)}catch(n){f=[6,n];u=0}finally{e=i=0}if(5&f[0])throw f[1];return{value:f[0]?f[1]:void 0,done:!0}}var e,u,i,o,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:f(0),"throw":f(1),"return":f(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o}function v(n,t){for(var i in n)t.hasOwnProperty(i)||(t[i]=n[i])}function u(n){var t="function"==typeof Symbol&&n[Symbol.iterator],i=0;return t?t.call(n):{next:function(){return n&&i>=n.length&&(n=void 0),{value:n&&n[i++],done:!n}}}}function f(n,t){var i="function"==typeof Symbol&&n[Symbol.iterator],r,f,u,e;if(!i)return n;u=i.call(n);e=[];try{for(;(void 0===t||t-->0)&&!(r=u.next()).done;)e.push(r.value)}catch(n){f={error:n}}finally{try{r&&!r.done&&(i=u.return)&&i.call(u)}finally{if(f)throw f.error;}}return e}function y(){for(var n=[],t=0;t<arguments.length;t++)n=n.concat(f(arguments[t]));return n}function r(n){return this instanceof r?(this.v=n,this):new r(n)}function p(n,t,i){function o(n){h[n]&&(e[n]=function(t){return new Promise(function(i,r){u.push([n,t,i,r])>1||f(n,t)})})}function f(n,t){try{c(h[n](t))}catch(n){s(u[0][3],n)}}function c(n){n.value instanceof r?Promise.resolve(n.value.v).then(l,a):s(u[0][2],n)}function l(n){f("next",n)}function a(n){f("throw",n)}function s(n,t){n(t);u.shift();u.length&&f(u[0][0],u[0][1])}if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,h=i.apply(n,t||[]),u=[];return e={},o("next"),o("throw"),o("return"),e[Symbol.asyncIterator]=function(){return this},e}function w(n){function i(i,f){t[i]=n[i]?function(t){return(u=!u)?{value:r(n[i](t)),done:"return"===i}:f?f(t):t}:f}var t,u;return t={},i("next"),i("throw",function(n){throw n;}),i("return"),t[Symbol.iterator]=function(){return this},t}function b(n){function i(i){t[i]=n[i]&&function(t){return new Promise(function(r,u){t=n[i](t);f(r,u,t.done,t.value)})}}function f(n,t,i,r){Promise.resolve(r).then(function(t){n({value:t,done:i})},t)}if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=n[Symbol.asyncIterator];return r?r.call(n):(n="function"==typeof u?u(n):n[Symbol.iterator](),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t)}function k(n,t){return Object.defineProperty?Object.defineProperty(n,"raw",{value:t}):n.raw=t,n}function d(n){var t,i;if(n&&n.__esModule)return n;if(t={},null!=n)for(i in n)Object.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t.default=n,t}function g(n){return n&&n.__esModule?n:{"default":n}}Object.defineProperty(t,"__esModule",{value:!0});t.__extends=e;i.d(t,"__assign",function(){return tt});t.__rest=o;t.__decorate=s;t.__param=h;t.__metadata=c;t.__awaiter=l;t.__generator=a;t.__exportStar=v;t.__values=u;t.__read=f;t.__spread=y;t.__await=r;t.__asyncGenerator=p;t.__asyncDelegator=w;t.__asyncValues=b;t.__makeTemplateObject=k;t.__importStar=d;t.__importDefault=g;
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0
THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.
See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
var nt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},tt=Object.assign||function(n){for(var t,r,i=1,u=arguments.length;i<u;i++){t=arguments[i];for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n}},function(n,t){"use strict";var i,r,u;Object.defineProperty(t,"__esModule",{value:!0});i=function(){function n(){}return Object.defineProperty(n,"errorDescription",{get:function(){return"error_description"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"error",{get:function(){return"error"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"scope",{get:function(){return"scope"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"acquireTokenUser",{get:function(){return"msal.acquireTokenUser"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"clientInfo",{get:function(){return"client_info"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"clientId",{get:function(){return"clientId"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"authority",{get:function(){return"msal.authority"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"idToken",{get:function(){return"id_token"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"accessToken",{get:function(){return"access_token"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"expiresIn",{get:function(){return"expires_in"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"sessionState",{get:function(){return"session_state"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"msalClientInfo",{get:function(){return"msal.client.info"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"msalError",{get:function(){return"msal.error"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"msalErrorDescription",{get:function(){return"msal.error.description"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"msalSessionState",{get:function(){return"msal.session.state"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"tokenKeys",{get:function(){return"msal.token.keys"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"accessTokenKey",{get:function(){return"msal.access.token.key"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"expirationKey",{get:function(){return"msal.expiration.key"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"stateLogin",{get:function(){return"msal.state.login"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"stateAcquireToken",{get:function(){return"msal.state.acquireToken"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"stateRenew",{get:function(){return"msal.state.renew"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"nonceIdToken",{get:function(){return"msal.nonce.idtoken"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"userName",{get:function(){return"msal.username"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"idTokenKey",{get:function(){return"msal.idtoken"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"loginRequest",{get:function(){return"msal.login.request"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"loginError",{get:function(){return"msal.login.error"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"renewStatus",{get:function(){return"msal.token.renew.status"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"msal",{get:function(){return"msal"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"resourceDelimeter",{get:function(){return"|"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"tokenRenewStatusCancelled",{get:function(){return"Canceled"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"tokenRenewStatusCompleted",{get:function(){return"Completed"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"tokenRenewStatusInProgress",{get:function(){return"In Progress"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"popUpWidth",{get:function(){return this._popUpWidth},set:function(n){this._popUpWidth=n},enumerable:!0,configurable:!0}),Object.defineProperty(n,"popUpHeight",{get:function(){return this._popUpHeight},set:function(n){this._popUpHeight=n},enumerable:!0,configurable:!0}),Object.defineProperty(n,"login",{get:function(){return"LOGIN"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"renewToken",{get:function(){return"RENEW_TOKEN"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"unknown",{get:function(){return"UNKNOWN"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"urlHash",{get:function(){return"msal.urlHash"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"angularLoginRequest",{get:function(){return"msal.angular.login.request"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"userIdentifier",{get:function(){return"userIdentifier"},enumerable:!0,configurable:!0}),n._popUpWidth=483,n._popUpHeight=600,n}();t.Constants=i;r=function(){function n(){}return Object.defineProperty(n,"loginProgressError",{get:function(){return"login_progress_error"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"acquireTokenProgressError",{get:function(){return"acquiretoken_progress_error"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"inputScopesError",{get:function(){return"input_scopes_error"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"endpointResolutionError",{get:function(){return"endpoints_resolution_error"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"popUpWindowError",{get:function(){return"popup_window_error"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"userLoginError",{get:function(){return"user_login_error"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"userCancelledError",{get:function(){return"user_cancelled"},enumerable:!0,configurable:!0}),n}();t.ErrorCodes=r;u=function(){function n(){}return Object.defineProperty(n,"loginProgressError",{get:function(){return"Login is in progress"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"acquireTokenProgressError",{get:function(){return"Acquire token is in progress"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"inputScopesError",{get:function(){return"Invalid value of input scopes provided"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"endpointResolutionError",{get:function(){return"Endpoints cannot be resolved"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"popUpWindowError",{get:function(){return"Error opening popup window. This can happen if you are using IE or if popups are blocked in the browser."},enumerable:!0,configurable:!0}),Object.defineProperty(n,"userLoginError",{get:function(){return"User login is required"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"userCancelledError",{get:function(){return"User closed the popup window window and cancelled the flow"},enumerable:!0,configurable:!0}),n}();t.ErrorDescription=u},function(n,t,i){"use strict";var r,u,f;Object.defineProperty(t,"__esModule",{value:!0});u=i(0);!function(n){n[n.Error=0]="Error";n[n.Warning=1]="Warning";n[n.Info=2]="Info";n[n.Verbose=3]="Verbose"}(r=t.LogLevel||(t.LogLevel={}));f=function(){function n(n,t){void 0===t&&(t={});this._level=r.Info;var i=t.correlationId,e=void 0===i?"":i,u=t.level,o=void 0===u?r.Info:u,f=t.piiLoggingEnabled,s=void 0!==f&&f;this._localCallback=n;this._correlationId=e;this._level=o;this._piiLoggingEnabled=s}return n.prototype.logMessage=function(n,t,i){if(!(n>this._level||!this._piiLoggingEnabled&&i)){var f,e=(new Date).toUTCString();f=u.Utils.isEmpty(this._correlationId)?e+":"+u.Utils.getLibraryVersion()+"-"+r[n]+" "+t:e+":"+this._correlationId+"-"+u.Utils.getLibraryVersion()+"-"+r[n]+" "+t;this.executeCallback(n,f,i)}},n.prototype.executeCallback=function(n,t,i){this._localCallback&&this._localCallback(n,t,i)},n.prototype.error=function(n){this.logMessage(r.Error,n,!1)},n.prototype.errorPii=function(n){this.logMessage(r.Error,n,!0)},n.prototype.warning=function(n){this.logMessage(r.Warning,n,!1)},n.prototype.warningPii=function(n){this.logMessage(r.Warning,n,!0)},n.prototype.info=function(n){this.logMessage(r.Info,n,!1)},n.prototype.infoPii=function(n){this.logMessage(r.Info,n,!0)},n.prototype.verbose=function(n){this.logMessage(r.Verbose,n,!1)},n.prototype.verbosePii=function(n){this.logMessage(r.Verbose,n,!0)},n}();t.Logger=f},function(n,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function n(){}return Object.defineProperty(n,"authorityUriInvalidPath",{get:function(){return"AuthorityUriInvalidPath"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"authorityUriInsecure",{get:function(){return"AuthorityUriInsecure"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"invalidAuthorityType",{get:function(){return"InvalidAuthorityType"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"unsupportedAuthorityValidation",{get:function(){return"UnsupportedAuthorityValidation"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"b2cAuthorityUriInvalidPath",{get:function(){return"B2cAuthorityUriInvalidPath"},enumerable:!0,configurable:!0}),n}();t.ErrorMessage=i},function(n,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function n(){this.valid=!1;this.parameters={};this.stateMatch=!1;this.stateResponse="";this.requestType="unknown"}return n}();t.TokenResponse=i},function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),u=function(){function n(n,t,i,r,u){this.displayableId=n;this.name=t;this.identityProvider=i;this.userIdentifier=r;this.idToken=u}return n.createUser=function(t,i){var u,f,e;return i?(u=i.uid,f=i.utid):(u="",f=""),e=r.Utils.base64EncodeStringUrlSafe(u)+"."+r.Utils.base64EncodeStringUrlSafe(f),new n(t.preferredName,t.name,t.issuer,e,t.decodedIdToken)},n}();t.User=u},function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=i(2),r=i(1),f=i(9),e=function(n){function t(t,i){return n.call(this,t,i)||this}return u.__extends(t,n),Object.defineProperty(t.prototype,"AadInstanceDiscoveryEndpointUrl",{get:function(){return t.AadInstanceDiscoveryEndpoint+"?api-version=1.0&authorization_endpoint="+this.CanonicalAuthority+"oauth2/v2.0/authorize"},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"AuthorityType",{get:function(){return r.AuthorityType.Aad},enumerable:!0,configurable:!0}),t.prototype.GetOpenIdConfigurationEndpointAsync=function(){var i=this,n=new Promise(function(n){return n(i.DefaultOpenIdConfigurationEndpoint)}),t;return this.IsValidationEnabled?(t=this.CanonicalAuthorityUrlComponents.HostNameAndPort,this.IsInTrustedHostList(t)?n:(new f.XhrClient).sendRequestAsync(this.AadInstanceDiscoveryEndpointUrl,"GET",!0).then(function(n){return n.tenant_discovery_endpoint})):n},t.prototype.IsInTrustedHostList=function(n){return t.TrustedHostList[n.toLowerCase()]},t.AadInstanceDiscoveryEndpoint="https://login.microsoftonline.com/common/discovery/instance",t.TrustedHostList={"login.windows.net":"login.windows.net","login.chinacloudapi.cn":"login.chinacloudapi.cn","login.cloudgovapi.us":"login.cloudgovapi.us","login.microsoftonline.com":"login.microsoftonline.com","login.microsoftonline.de":"login.microsoftonline.de","login.microsoftonline.us":"login.microsoftonline.us"},t}(r.Authority);t.AadAuthority=e},function(n,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function n(){}return n.prototype.sendRequestAsync=function(n,t){var i=this;return new Promise(function(r,u){var f=new XMLHttpRequest;if(f.open(t,n,!0),f.onload=function(){(f.status<200||f.status>=300)&&u(i.handleError(f.responseText));try{var n=JSON.parse(f.responseText)}catch(e){u(i.handleError(f.responseText))}r(n)},f.onerror=function(){u(f.status)},"GET"!==t)throw"not implemented";f.send()})},n.prototype.handleError=function(n){var t;try{if(t=JSON.parse(n),t.error)return t.error;throw n;}catch(t){return n}},n}();t.XhrClient=i},function(n,t,i){n.exports=i(11)},function(n,t,i){"use strict";var r,u,f,e,o,s,h;Object.defineProperty(t,"__esModule",{value:!0});r=i(12);t.UserAgentApplication=r.UserAgentApplication;u=i(4);t.Logger=u.Logger;f=i(4);t.LogLevel=f.LogLevel;e=i(7);t.User=e.User;o=i(3);t.Constants=o.Constants;s=i(6);t.TokenResponse=s.TokenResponse;h=i(1);t.Authority=h.Authority},function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var v=i(2),l=i(13),a=i(14),f=i(15),s=i(16),r=i(3),h=i(17),y=i(4),p=i(18),w=i(6),c=i(7),u=i(0),o=i(20),e={id_token:"id_token",token:"token",id_token_token:"id_token token"},b=function(n,t,i){var r=i.value;return i.value=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return this.isInIframe()?new Promise(function(){}):r.apply(this,t)},i},k=function(){function n(n,t,i,u){var f,g,e;void 0===u&&(u={});this._cacheLocations={localStorage:"localStorage",sessionStorage:"sessionStorage"};this._clockSkew=300;this._tokenReceivedCallback=null;this._isAngular=!1;var o=u.validateAuthority,nt=void 0===o||o,s=u.cacheLocation,h=void 0===s?"sessionStorage":s,c=u.redirectUri,tt=void 0===c?window.location.href.split("?")[0].split("#")[0]:c,l=u.postLogoutRedirectUri,it=void 0===l?window.location.href.split("?")[0].split("#")[0]:l,a=u.logger,rt=void 0===a?new y.Logger(null):a,v=u.loadFrameTimeout,ut=void 0===v?6e3:v,w=u.navigateToLoginRequestUrl,ft=void 0===w||w,b=u.isAngular,et=void 0!==b&&b,k=u.anonymousEndpoints,ot=void 0===k?[]:k,d=u.endPoints,st=void 0===d?new Map:d;if(this.loadFrameTimeout=ut,this.clientId=n,this.validateAuthority=nt,this.authority=t||"https://login.microsoftonline.com/common",this._tokenReceivedCallback=i,this._redirectUri=tt,this._postLogoutredirectUri=it,this._loginInProgress=!1,this._acquireTokenInProgress=!1,this._cacheLocation=h,this._navigateToLoginRequestUrl=ft,this._isAngular=et,this._anonymousEndpoints=ot,this._endpoints=st,!this._cacheLocations[h])throw new Error("Cache Location is not valid. Provided value:"+this._cacheLocation+".Possible values are: "+this._cacheLocations.localStorage+", "+this._cacheLocations.sessionStorage);this._cacheStorage=new p.Storage(this._cacheLocation);this._logger=rt;window.openedWindows=[];window.activeRenewals={};window.renewStates=[];window.callBackMappedToRenewStates={};window.callBacksMappedToRenewStates={};window.msal=this;f=window.location.hash;g=this.isCallback(f);this._isAngular||(g?this.handleAuthenticationResponse.call(this,f):(e=this._cacheStorage.getItem(r.Constants.urlHash),e&&this.processCallBack(e)))}return Object.defineProperty(n.prototype,"cacheLocation",{get:function(){return this._cacheLocation},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"authority",{get:function(){return this.authorityInstance.CanonicalAuthority},set:function(n){this.authorityInstance=o.AuthorityFactory.CreateInstance(n,this.validateAuthority)},enumerable:!0,configurable:!0}),n.prototype.processCallBack=function(n){var t;this._logger.info("Processing the callback from redirect response");t=this.getRequestInfo(n);this.saveTokenFromHash(t);var i,u=t.parameters[r.Constants.accessToken]||t.parameters[r.Constants.idToken],f=t.parameters[r.Constants.errorDescription],e=t.parameters[r.Constants.error];i=t.parameters[r.Constants.accessToken]?r.Constants.accessToken:r.Constants.idToken;this._cacheStorage.removeItem(r.Constants.urlHash);try{this._tokenReceivedCallback&&this._tokenReceivedCallback.call(this,f,u,e,i)}catch(n){this._logger.error("Error occurred in token received callback function: "+n)}},n.prototype.loginRedirect=function(n,t){var i=this,o;if(this._loginInProgress&&this._tokenReceivedCallback)return void this._tokenReceivedCallback(r.ErrorDescription.loginProgressError,null,r.ErrorCodes.loginProgressError,r.Constants.idToken);if(n){if(o=this.validateInputScope(n),o&&!u.Utils.isEmpty(o)&&this._tokenReceivedCallback)return void this._tokenReceivedCallback(r.ErrorDescription.inputScopesError,null,r.ErrorCodes.inputScopesError,r.Constants.idToken);n=this.filterScopes(n)}this._loginInProgress=!0;this.authorityInstance.ResolveEndpointsAsync().then(function(){var o=new f.AuthenticationRequestParameters(i.authorityInstance,i.clientId,n,e.id_token,i._redirectUri),s,h,c;t&&(o.extraQueryParameters=t);s=i._cacheStorage.getItem(r.Constants.angularLoginRequest);s&&""!==s?i._cacheStorage.setItem(r.Constants.angularLoginRequest,""):s=window.location.href;i._cacheStorage.setItem(r.Constants.loginRequest,s);i._cacheStorage.setItem(r.Constants.loginError,"");i._cacheStorage.setItem(r.Constants.stateLogin,o.state);i._cacheStorage.setItem(r.Constants.nonceIdToken,o.nonce);i._cacheStorage.setItem(r.Constants.msalError,"");i._cacheStorage.setItem(r.Constants.msalErrorDescription,"");h=r.Constants.authority+r.Constants.resourceDelimeter+o.state;u.Utils.isEmpty(i._cacheStorage.getItem(h))&&i._cacheStorage.setItem(h,i.authority);c=o.createNavigateUrl(n)+"&prompt=select_account&response_mode=fragment";i.promptUser(c)})},n.prototype.loginPopup=function(n,t){var i=this;return new Promise(function(o,s){var c,l,h;if(i._loginInProgress)return void s(r.ErrorCodes.loginProgressError+"|"+r.ErrorDescription.loginProgressError);if(n){if(c=i.validateInputScope(n),c&&!u.Utils.isEmpty(c))return void s(r.ErrorCodes.inputScopesError+"|"+r.ErrorDescription.inputScopesError);n=i.filterScopes(n)}else n=[i.clientId];l=n.join(" ").toLowerCase();h=i.openWindow("about:blank","_blank",1,i,o,s);h&&(i._loginInProgress=!0,i.authorityInstance.ResolveEndpointsAsync().then(function(){var c=new f.AuthenticationRequestParameters(i.authorityInstance,i.clientId,n,e.id_token,i._redirectUri),a,v;t&&(c.extraQueryParameters=t);i._cacheStorage.setItem(r.Constants.loginRequest,window.location.href);i._cacheStorage.setItem(r.Constants.loginError,"");i._cacheStorage.setItem(r.Constants.nonceIdToken,c.nonce);i._cacheStorage.setItem(r.Constants.msalError,"");i._cacheStorage.setItem(r.Constants.msalErrorDescription,"");a=r.Constants.authority+r.Constants.resourceDelimeter+c.state;u.Utils.isEmpty(i._cacheStorage.getItem(a))&&i._cacheStorage.setItem(a,i.authority);v=c.createNavigateUrl(n)+"&prompt=select_account&response_mode=fragment";window.renewStates.push(c.state);window.requestType=r.Constants.login;i.registerCallback(c.state,l,o,s);h&&(i._logger.infoPii("Navigated Popup window to:"+v),h.location.href=v)},function(){i._logger.info(r.ErrorCodes.endpointResolutionError+":"+r.ErrorDescription.endpointResolutionError);i._cacheStorage.setItem(r.Constants.msalError,r.ErrorCodes.endpointResolutionError);i._cacheStorage.setItem(r.Constants.msalErrorDescription,r.ErrorDescription.endpointResolutionError);s&&s(r.ErrorCodes.endpointResolutionError+":"+r.ErrorDescription.endpointResolutionError);h&&h.close()}).catch(function(n){i._logger.warning("could not resolve endpoints");s(n)}))})},n.prototype.promptUser=function(n){n&&!u.Utils.isEmpty(n)?(this._logger.infoPii("Navigate to:"+n),window.location.replace(n)):this._logger.info("Navigate url is empty")},n.prototype.openWindow=function(n,t,i,u,f,e){var o=this,s=this.openPopup(n,t,r.Constants.popUpWidth,r.Constants.popUpHeight),h;return null==s?(u._loginInProgress=!1,u._acquireTokenInProgress=!1,this._logger.info(r.ErrorCodes.popUpWindowError+":"+r.ErrorDescription.popUpWindowError),this._cacheStorage.setItem(r.Constants.msalError,r.ErrorCodes.popUpWindowError),this._cacheStorage.setItem(r.Constants.msalErrorDescription,r.ErrorDescription.popUpWindowError),e&&e(r.ErrorCodes.popUpWindowError+"|"+r.ErrorDescription.popUpWindowError),null):(window.openedWindows.push(s),h=window.setInterval(function(){var t,n;if(s&&s.closed&&u._loginInProgress){if(e&&e(r.ErrorCodes.userCancelledError+"|"+r.ErrorDescription.userCancelledError),window.clearInterval(h),o._isAngular)return void o.broadcast("msal:popUpClosed",r.ErrorCodes.userCancelledError+"|"+r.ErrorDescription.userCancelledError);u._loginInProgress=!1;u._acquireTokenInProgress=!1}try{if(t=s.location,-1!==t.href.indexOf(o._redirectUri)&&(window.clearInterval(h),u._loginInProgress=!1,u._acquireTokenInProgress=!1,o._logger.info("Closing popup window"),o._isAngular))for(o.broadcast("msal:popUpHashChanged",t.hash),n=0;n<window.openedWindows.length;n++)window.openedWindows[n].close()}catch(t){}},i),s)},n.prototype.broadcast=function(n,t){var i=new CustomEvent(n,{detail:t});window.dispatchEvent(i)},n.prototype.logout=function(){var n,t;this.clearCache();this._user=null;n="";this._postLogoutredirectUri&&(n="post_logout_redirect_uri="+encodeURIComponent(this._postLogoutredirectUri));t=this.authority+"/oauth2/v2.0/logout?"+n;this.promptUser(t)},n.prototype.clearCache=function(){window.renewStates=[];for(var t=this._cacheStorage.getAllAccessTokens(r.Constants.clientId,r.Constants.userIdentifier),n=0;n<t.length;n++)this._cacheStorage.removeItem(JSON.stringify(t[n].key));this._cacheStorage.resetCacheItems()},n.prototype.clearCacheForScope=function(n){for(var u,i=this._cacheStorage.getAllAccessTokens(r.Constants.clientId,r.Constants.userIdentifier),t=0;t<i.length;t++)u=i[t],u.value.accessToken==n&&this._cacheStorage.removeItem(JSON.stringify(u.key))},n.prototype.openPopup=function(n,t,i,r){try{var f=window.screenLeft?window.screenLeft:window.screenX,e=window.screenTop?window.screenTop:window.screenY,o=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,s=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,h=o/2-i/2+f,c=s/2-r/2+e,u=window.open(n,t,"width="+i+", height="+r+", top="+c+", left="+h);return u.focus&&u.focus(),u}catch(n){return this._logger.error("error opening popup "+n.message),this._loginInProgress=!1,this._acquireTokenInProgress=!1,null}},n.prototype.validateInputScope=function(n){if(!n||n.length<1)return"Scopes cannot be passed as an empty array";if(!Array.isArray(n))throw new Error("API does not accept non-array scopes");return n.indexOf(this.clientId)>-1&&n.length>1?"ClientId can only be provided as a single scope":""},n.prototype.filterScopes=function(n){return n=n.filter(function(n){return"openid"!==n}),n=n.filter(function(n){return"profile"!==n})},n.prototype.registerCallback=function(n,t,i,r){var u=this;window.activeRenewals[t]=n;window.callBacksMappedToRenewStates[n]||(window.callBacksMappedToRenewStates[n]=[]);window.callBacksMappedToRenewStates[n].push({resolve:i,reject:r});window.callBackMappedToRenewStates[n]||(window.callBackMappedToRenewStates[n]=function(i,r,f){window.activeRenewals[t]=null;for(var e=0;e<window.callBacksMappedToRenewStates[n].length;++e)try{i||f?window.callBacksMappedToRenewStates[n][e].reject(i+"|"+f):r&&window.callBacksMappedToRenewStates[n][e].resolve(r)}catch(n){u._logger.warning(n)}window.callBacksMappedToRenewStates[n]=null;window.callBackMappedToRenewStates[n]=null})},n.prototype.getCachedTokenInternal=function(n,t){var r=t||this.getUser(),s,i;if(r)return i=this.authorityInstance?this.authorityInstance:o.AuthorityFactory.CreateInstance(this.authority,this.validateAuthority),s=u.Utils.compareObjects(r,this.getUser())?n.indexOf(this.clientId)>-1?new f.AuthenticationRequestParameters(i,this.clientId,n,e.id_token,this._redirectUri):new f.AuthenticationRequestParameters(i,this.clientId,n,e.token,this._redirectUri):new f.AuthenticationRequestParameters(i,this.clientId,n,e.id_token_token,this._redirectUri),this.getCachedToken(s,t)},n.prototype.getCachedToken=function(n,t){var e=null,a=n.scopes,s=this._cacheStorage.getAllAccessTokens(this.clientId,t?t.userIdentifier:null),i,r,f,h,c,l,v;if(0===s.length)return null;if(i=[],n.authority){for(r=0;r<s.length;r++)f=s[r],h=f.key.scopes.split(" "),u.Utils.containsScope(h,a)&&f.key.authority===n.authority&&i.push(f);if(0===i.length)return null;if(1!==i.length)return{errorDesc:"The cache contains multiple tokens satisfying the requirements.Call AcquireToken again providing more requirements like authority",token:null,error:"multiple_matching_tokens_detected"};e=i[0]}else{for(r=0;r<s.length;r++)f=s[r],h=f.key.scopes.split(" "),u.Utils.containsScope(h,a)&&i.push(f);if(1===i.length)e=i[0],n.authorityInstance=o.AuthorityFactory.CreateInstance(e.key.authority,this.validateAuthority);else{if(i.length>1)return{errorDesc:"The cache contains multiple tokens satisfying the requirements. Call AcquireToken again providing more requirements like authority",token:null,error:"multiple_matching_tokens_detected"};if(c=this.getUniqueAuthority(s,"authority"),c.length>1)return{errorDesc:"Multiple authorities found in the cache. Pass authority in the API overload.",token:null,error:"multiple_matching_tokens_detected"};n.authorityInstance=o.AuthorityFactory.CreateInstance(c[0],this.validateAuthority)}}return null!=e?(l=Number(e.value.expiresIn),v=this._clockSkew||300,l&&l>u.Utils.now()+v?{errorDesc:null,token:e.value.accessToken,error:null}:(this._cacheStorage.removeItem(JSON.stringify(i[0].key)),null)):null},n.prototype.getAllUsers=function(){for(var i=[],t=this._cacheStorage.getAllAccessTokens(r.Constants.clientId,r.Constants.userIdentifier),n=0;n<t.length;n++){var u=new h.IdToken(t[n].value.idToken),f=new s.ClientInfo(t[n].value.clientInfo),e=c.User.createUser(u,f,this.authority);i.push(e)}return this.getUniqueUsers(i)},n.prototype.getUniqueUsers=function(n){if(!n||n.length<=1)return n;for(var i=[],r=[],t=0;t<n.length;++t)n[t].userIdentifier&&-1===i.indexOf(n[t].userIdentifier)&&(i.push(n[t].userIdentifier),r.push(n[t]));return r},n.prototype.getUniqueAuthority=function(n,t){var i=[],r=[];return n.forEach(function(n){n.key.hasOwnProperty(t)&&-1===r.indexOf(n.key[t])&&(r.push(n.key[t]),i.push(n.key[t]))}),i},n.prototype.addHintParameters=function(n,t){var r=t||this.getUser(),e=r.userIdentifier.split("."),f=u.Utils.base64DecodeStringUrlSafe(e[0]),i=u.Utils.base64DecodeStringUrlSafe(e[1]);return this.urlContainsQueryStringParameter("login_hint",n)||!r.displayableId||u.Utils.isEmpty(r.displayableId)||(n+="&login_hint="+encodeURIComponent(t.displayableId)),u.Utils.isEmpty(f)||u.Utils.isEmpty(i)||(this.urlContainsQueryStringParameter("domain_req",n)||u.Utils.isEmpty(i)||(n+="&domain_req="+encodeURIComponent(i)),this.urlContainsQueryStringParameter("login_req",n)||u.Utils.isEmpty(f)||(n+="&login_req="+encodeURIComponent(f)),this.urlContainsQueryStringParameter("domain_hint",n)||u.Utils.isEmpty(i)||(n+="9188040d-6c67-4c5b-b112-36a304b66dad"===i?"&domain_hint="+encodeURIComponent("consumers"):"&domain_hint="+encodeURIComponent("organizations"))),n},n.prototype.urlContainsQueryStringParameter=function(n,t){return new RegExp("[\\?&]"+n+"=").test(t)},n.prototype.acquireTokenRedirect=function(n,t,i,s){var h=this,v=this.validateInputScope(n),l,c,a;if(v&&!u.Utils.isEmpty(v)&&this._tokenReceivedCallback)return void this._tokenReceivedCallback(r.ErrorDescription.inputScopesError,null,r.ErrorCodes.inputScopesError,r.Constants.accessToken);if(n&&(n=this.filterScopes(n)),l=i||this.getUser(),!this._acquireTokenInProgress){if(n.join(" ").toLowerCase(),!l&&this._tokenReceivedCallback)return void this._tokenReceivedCallback(r.ErrorDescription.userLoginError,null,r.ErrorCodes.userLoginError,r.Constants.accessToken);this._acquireTokenInProgress=!0;a=t?o.AuthorityFactory.CreateInstance(t,this.validateAuthority):this.authorityInstance;a.ResolveEndpointsAsync().then(function(){var i,o,t;c=u.Utils.compareObjects(l,h.getUser())?new f.AuthenticationRequestParameters(a,h.clientId,n,e.token,h._redirectUri):new f.AuthenticationRequestParameters(a,h.clientId,n,e.id_token_token,h._redirectUri);h._cacheStorage.setItem(r.Constants.nonceIdToken,c.nonce);i=r.Constants.acquireTokenUser+r.Constants.resourceDelimeter+l.userIdentifier+r.Constants.resourceDelimeter+c.state;u.Utils.isEmpty(h._cacheStorage.getItem(i))&&h._cacheStorage.setItem(i,JSON.stringify(l));o=r.Constants.authority+r.Constants.resourceDelimeter+c.state;u.Utils.isEmpty(h._cacheStorage.getItem(o))&&h._cacheStorage.setItem(o,a.CanonicalAuthority);s&&(c.extraQueryParameters=s);t=c.createNavigateUrl(n)+"&prompt=select_account&response_mode=fragment";(t=h.addHintParameters(t,l))&&(h._cacheStorage.setItem(r.Constants.stateAcquireToken,c.state),window.location.replace(t))})}},n.prototype.acquireTokenPopup=function(n,t,i,s){var h=this;return new Promise(function(c,l){var w=h.validateInputScope(n),v,b,a,y,p;if(w&&!u.Utils.isEmpty(w)&&l(r.ErrorCodes.inputScopesError+"|"+w),n&&(n=h.filterScopes(n)),v=i||h.getUser(),h._acquireTokenInProgress)return void l(r.ErrorCodes.acquireTokenProgressError+"|"+r.ErrorDescription.acquireTokenProgressError);if(b=n.join(" ").toLowerCase(),!v)return void l(r.ErrorCodes.userLoginError+"|"+r.ErrorDescription.userLoginError);h._acquireTokenInProgress=!0;y=t?o.AuthorityFactory.CreateInstance(t,h.validateAuthority):h.authorityInstance;p=h.openWindow("about:blank","_blank",1,h,c,l);p&&y.ResolveEndpointsAsync().then(function(){var i,o,t;a=u.Utils.compareObjects(v,h.getUser())?n.indexOf(h.clientId)>-1?new f.AuthenticationRequestParameters(y,h.clientId,n,e.id_token,h._redirectUri):new f.AuthenticationRequestParameters(y,h.clientId,n,e.token,h._redirectUri):new f.AuthenticationRequestParameters(y,h.clientId,n,e.id_token_token,h._redirectUri);h._cacheStorage.setItem(r.Constants.nonceIdToken,a.nonce);a.state=a.state;i=r.Constants.acquireTokenUser+r.Constants.resourceDelimeter+v.userIdentifier+r.Constants.resourceDelimeter+a.state;u.Utils.isEmpty(h._cacheStorage.getItem(i))&&h._cacheStorage.setItem(i,JSON.stringify(v));o=r.Constants.authority+r.Constants.resourceDelimeter+a.state;u.Utils.isEmpty(h._cacheStorage.getItem(o))&&h._cacheStorage.setItem(o,y.CanonicalAuthority);s&&(a.extraQueryParameters=s);t=a.createNavigateUrl(n)+"&prompt=select_account&response_mode=fragment";t=h.addHintParameters(t,v);window.renewStates.push(a.state);window.requestType=r.Constants.renewToken;h.registerCallback(a.state,b,c,l);p&&(p.location.href=t)},function(){h._logger.info(r.ErrorCodes.endpointResolutionError+":"+r.ErrorDescription.endpointResolutionError);h._cacheStorage.setItem(r.Constants.msalError,r.ErrorCodes.endpointResolutionError);h._cacheStorage.setItem(r.Constants.msalErrorDescription,r.ErrorDescription.endpointResolutionError);l&&l(r.ErrorCodes.endpointResolutionError+"|"+r.ErrorDescription.endpointResolutionError);p&&p.close()}).catch(function(n){h._logger.warning("could not resolve endpoints");l(n)})})},n.prototype.acquireTokenSilent=function(n,t,i,s){var h=this;return new Promise(function(c,l){var b=h.validateInputScope(n),v,y,w,p,a;if(!b||u.Utils.isEmpty(b)){if(n&&(n=h.filterScopes(n)),v=n.join(" ").toLowerCase(),y=i||h.getUser(),!y)return void l(r.ErrorCodes.userLoginError+"|"+r.ErrorDescription.userLoginError);if(p=t?o.AuthorityFactory.CreateInstance(t,h.validateAuthority):h.authorityInstance,w=u.Utils.compareObjects(y,h.getUser())?n.indexOf(h.clientId)>-1?new f.AuthenticationRequestParameters(p,h.clientId,n,e.id_token,h._redirectUri):new f.AuthenticationRequestParameters(p,h.clientId,n,e.token,h._redirectUri):new f.AuthenticationRequestParameters(p,h.clientId,n,e.id_token_token,h._redirectUri),a=h.getCachedToken(w,y),a){if(a.token)return h._logger.info("Token is already in cache for scope:"+v),void c(a.token);if(a.errorDesc||a.error)return h._logger.infoPii(a.errorDesc+":"+a.error),void l(a.errorDesc+"|"+a.error)}else h._logger.verbose("Token is not in cache for scope:"+v);return p.ResolveEndpointsAsync().then(function(){window.activeRenewals[v]?(h._logger.verbose("Renew token for scope: "+v+" is in progress. Registering callback"),h.registerCallback(window.activeRenewals[v],v,c,l)):n&&n.indexOf(h.clientId)>-1&&1===n.length?(h._logger.verbose("renewing idToken"),h.renewIdToken(n,c,l,y,w,s)):(h._logger.verbose("renewing accesstoken"),h.renewToken(n,c,l,y,w,s))}).catch(function(n){h._logger.warning("could not resolve endpoints");l(n)})}l(r.ErrorCodes.inputScopesError+"|"+b)})},n.prototype.loadIframeTimeout=function(n,t,i){var f=this,u=window.activeRenewals[i];this._logger.verbose("Set loading state to pending for: "+i+":"+u);this._cacheStorage.setItem(r.Constants.renewStatus+u,r.Constants.tokenRenewStatusInProgress);this.loadFrame(n,t);setTimeout(function(){f._cacheStorage.getItem(r.Constants.renewStatus+u)===r.Constants.tokenRenewStatusInProgress&&(f._logger.verbose("Loading frame has timed out after: "+f.loadFrameTimeout/1e3+" seconds for scope "+i+":"+u),u&&window.callBackMappedToRenewStates[u]&&window.callBackMappedToRenewStates[u]("Token renewal operation failed due to timeout",null,"Token Renewal Failed",r.Constants.accessToken),f._cacheStorage.setItem(r.Constants.renewStatus+u,r.Constants.tokenRenewStatusCancelled))},this.loadFrameTimeout)},n.prototype.loadFrame=function(n,t){var i=this,r;this._logger.info("LoadFrame: "+t);r=t;setTimeout(function(){var u=i.addAdalFrame(r);""!==u.src&&"about:blank"!==u.src||(u.src=n,i._logger.infoPii("Frame Name : "+t+" Navigated to: "+n))},500)},n.prototype.addAdalFrame=function(n){var i,t;return void 0===n?null:(this._logger.info("Add msal frame to document:"+n),i=document.getElementById(n),i||(document.createElement&&document.documentElement&&-1===window.navigator.userAgent.indexOf("MSIE 5.0")?(t=document.createElement("iframe"),t.setAttribute("id",n),t.style.visibility="hidden",t.style.position="absolute",t.style.width=t.style.height="0",t.style.border="0",i=document.getElementsByTagName("body")[0].appendChild(t)):document.body&&document.body.insertAdjacentHTML&&document.body.insertAdjacentHTML("beforeend",'<iframe name="'+n+'" id="'+n+'" style="display:none"><\/iframe>'),window.frames&&window.frames[n]&&(i=window.frames[n])),i)},n.prototype.renewToken=function(n,t,i,f,e,o){var s=n.join(" ").toLowerCase(),a,c,l,h;this._logger.verbose("renewToken is called for scope:"+s);a=this.addAdalFrame("msalRenewFrame"+s);o&&(e.extraQueryParameters=o);c=r.Constants.acquireTokenUser+r.Constants.resourceDelimeter+f.userIdentifier+r.Constants.resourceDelimeter+e.state;u.Utils.isEmpty(this._cacheStorage.getItem(c))&&this._cacheStorage.setItem(c,JSON.stringify(f));l=r.Constants.authority+r.Constants.resourceDelimeter+e.state;u.Utils.isEmpty(this._cacheStorage.getItem(l))&&this._cacheStorage.setItem(l,e.authority);this._cacheStorage.setItem(r.Constants.nonceIdToken,e.nonce);this._logger.verbose("Renew token Expected state: "+e.state);h=e.createNavigateUrl(n)+"&prompt=none";h=this.addHintParameters(h,f);window.renewStates.push(e.state);window.requestType=r.Constants.renewToken;this.registerCallback(e.state,s,t,i);this._logger.infoPii("Navigate to:"+h);a.src="about:blank";this.loadIframeTimeout(h,"msalRenewFrame"+s,s)},n.prototype.renewIdToken=function(n,t,i,f,e,o){var l,h,c,s;n.join(" ").toLowerCase();this._logger.info("renewidToken is called");l=this.addAdalFrame("msalIdTokenFrame");o&&(e.extraQueryParameters=o);h=r.Constants.acquireTokenUser+r.Constants.resourceDelimeter+f.userIdentifier+r.Constants.resourceDelimeter+e.state;u.Utils.isEmpty(this._cacheStorage.getItem(h))&&this._cacheStorage.setItem(h,JSON.stringify(f));c=r.Constants.authority+r.Constants.resourceDelimeter+e.state;u.Utils.isEmpty(this._cacheStorage.getItem(c))&&this._cacheStorage.setItem(c,e.authority);this._cacheStorage.setItem(r.Constants.nonceIdToken,e.nonce);this._logger.verbose("Renew Idtoken Expected state: "+e.state);s=e.createNavigateUrl(n)+"&prompt=none";s=this.addHintParameters(s,f);window.renewStates.push(e.state);window.requestType=r.Constants.renewToken;this.registerCallback(e.state,this.clientId,t,i);this._logger.infoPii("Navigate to:"+s);l.src="about:blank";this.loadIframeTimeout(s,"msalIdTokenFrame",this.clientId)},n.prototype.getUser=function(){var n,t,i,f;return this._user?this._user:(n=this._cacheStorage.getItem(r.Constants.idTokenKey),t=this._cacheStorage.getItem(r.Constants.msalClientInfo),!u.Utils.isEmpty(n)&&!u.Utils.isEmpty(t))?(i=new h.IdToken(n),f=new s.ClientInfo(t),this._user=c.User.createUser(i,f,this.authority),this._user):null},n.prototype.handleAuthenticationResponse=function(n){var c,l,e;null==n&&(n=window.location.hash);var t=null,h=!1,f=!1;try{f=window.opener&&window.opener.msal&&window.opener.msal!==window.msal}catch(n){f=!1}f?(t=window.opener.msal,h=!0):window.parent&&window.parent.msal&&(t=window.parent.msal);var o,i=t.getRequestInfo(n),s=null,u=null;if(t._logger.info("Returned from redirect url"),window.parent!==window&&window.parent.msal)u=window.parent.callBackMappedToRenewStates[i.stateResponse];else if(f)u=window.opener.callBackMappedToRenewStates[i.stateResponse];else{if(t._navigateToLoginRequestUrl)return u=null,t._cacheStorage.setItem(r.Constants.urlHash,n),!1,void(window.parent!==window||h||(window.location.href=t._cacheStorage.getItem(r.Constants.loginRequest)));u=t._tokenReceivedCallback;window.location.hash=""}t.saveTokenFromHash(i);i.requestType===r.Constants.renewToken&&window.parent?(window.parent!==window?t._logger.verbose("Window is in iframe, acquiring token silently"):t._logger.verbose("acquiring token interactive in progress"),s=i.parameters[r.Constants.accessToken]||i.parameters[r.Constants.idToken],o=r.Constants.accessToken):i.requestType===r.Constants.login&&(s=i.parameters[r.Constants.idToken],o=r.Constants.idToken);c=i.parameters[r.Constants.errorDescription];l=i.parameters[r.Constants.error];try{u&&u.call(t,c,s,l,o)}catch(n){t._logger.error("Error occurred in token received callback function: "+n)}if(f)for(e=0;e<window.opener.openedWindows.length;e++)window.opener.openedWindows[e].close()},n.prototype.saveAccessToken=function(n,t,i,f,e){var o,h=new s.ClientInfo(f),c,b,v,y;if(t.parameters.hasOwnProperty("scope")){o=t.parameters.scope;for(var k=o.split(" "),w=this._cacheStorage.getAllAccessTokens(this.clientId,n),p=0;p<w.length;p++)c=w[p],c.key.userIdentifier===i.userIdentifier&&(b=c.key.scopes.split(" "),u.Utils.isIntersectingScopes(b,k)&&this._cacheStorage.removeItem(JSON.stringify(c.key)));v=new l.AccessTokenKey(n,this.clientId,o,h.uid,h.utid);y=new a.AccessTokenValue(t.parameters[r.Constants.accessToken],e.rawIdToken,u.Utils.expiresIn(t.parameters[r.Constants.expiresIn]).toString(),f);this._cacheStorage.setItem(JSON.stringify(v),JSON.stringify(y))}else o=this.clientId,v=new l.AccessTokenKey(n,this.clientId,o,h.uid,h.utid),y=new a.AccessTokenValue(t.parameters[r.Constants.idToken],t.parameters[r.Constants.idToken],e.expiration,f),this._cacheStorage.setItem(JSON.stringify(v),JSON.stringify(y))},n.prototype.saveTokenFromHash=function(n){var y,t,e,o,a,i;this._logger.info("State status:"+n.stateMatch+"; Request type:"+n.requestType);this._cacheStorage.setItem(r.Constants.msalError,"");this._cacheStorage.setItem(r.Constants.msalErrorDescription,"");var v="",f="",l="";(v=n.parameters.hasOwnProperty("scope")?n.parameters.scope.toLowerCase():this.clientId,n.parameters.hasOwnProperty(r.Constants.errorDescription)||n.parameters.hasOwnProperty(r.Constants.error))?(this._logger.infoPii("Error :"+n.parameters[r.Constants.error]+"; Error description:"+n.parameters[r.Constants.errorDescription]),this._cacheStorage.setItem(r.Constants.msalError,n.parameters.error),this._cacheStorage.setItem(r.Constants.msalErrorDescription,n.parameters[r.Constants.errorDescription]),n.requestType===r.Constants.login&&(this._loginInProgress=!1,this._cacheStorage.setItem(r.Constants.loginError,n.parameters[r.Constants.errorDescription]+":"+n.parameters[r.Constants.error]),f=r.Constants.authority+r.Constants.resourceDelimeter+n.stateResponse),n.requestType===r.Constants.renewToken)&&(this._acquireTokenInProgress=!1,f=r.Constants.authority+r.Constants.resourceDelimeter+n.stateResponse,y=null!==this.getUser()?this.getUser().userIdentifier:"",l=r.Constants.acquireTokenUser+r.Constants.resourceDelimeter+y+r.Constants.resourceDelimeter+n.stateResponse):n.stateMatch?(this._logger.info("State is right"),n.parameters.hasOwnProperty(r.Constants.sessionState)&&this._cacheStorage.setItem(r.Constants.msalSessionState,n.parameters[r.Constants.sessionState]),e="",n.parameters.hasOwnProperty(r.Constants.accessToken)&&(this._logger.info("Fragment has access token"),this._acquireTokenInProgress=!1,o=void 0,t=n.parameters.hasOwnProperty(r.Constants.idToken)?new h.IdToken(n.parameters[r.Constants.idToken]):new h.IdToken(this._cacheStorage.getItem(r.Constants.idTokenKey)),f=r.Constants.authority+r.Constants.resourceDelimeter+n.stateResponse,i=void 0,u.Utils.isEmpty(this._cacheStorage.getItem(f))||(i=this._cacheStorage.getItem(f),i=u.Utils.replaceFirstPath(i,t.tenantId)),n.parameters.hasOwnProperty(r.Constants.clientInfo)?(e=n.parameters[r.Constants.clientInfo],o=c.User.createUser(t,new s.ClientInfo(e),i)):(this._logger.warning("ClientInfo not received in the response from AAD"),o=c.User.createUser(t,new s.ClientInfo(e),i)),l=r.Constants.acquireTokenUser+r.Constants.resourceDelimeter+o.userIdentifier+r.Constants.resourceDelimeter+n.stateResponse,a=void 0,u.Utils.isEmpty(this._cacheStorage.getItem(l))||(a=JSON.parse(this._cacheStorage.getItem(l)),o&&a&&u.Utils.compareObjects(o,a)?(this.saveAccessToken(i,n,o,e,t),this._logger.info("The user object received in the response is the same as the one passed in the acquireToken request")):this._logger.warning("The user object created from the response is not the same as the one passed in the acquireToken request"))),n.parameters.hasOwnProperty(r.Constants.idToken)&&v.indexOf(this.clientId)>-1&&(this._logger.info("Fragment has id token"),this._loginInProgress=!1,t=new h.IdToken(n.parameters[r.Constants.idToken]),n.parameters.hasOwnProperty(r.Constants.clientInfo)?e=n.parameters[r.Constants.clientInfo]:this._logger.warning("ClientInfo not received in the response from AAD"),f=r.Constants.authority+r.Constants.resourceDelimeter+n.stateResponse,i=void 0,u.Utils.isEmpty(this._cacheStorage.getItem(f))||(i=this._cacheStorage.getItem(f),i=u.Utils.replaceFirstPath(i,t.tenantId)),this._user=c.User.createUser(t,new s.ClientInfo(e),i),t&&t.nonce?t.nonce!==this._cacheStorage.getItem(r.Constants.nonceIdToken)?(this._user=null,this._cacheStorage.setItem(r.Constants.loginError,"Nonce Mismatch. Expected Nonce: "+this._cacheStorage.getItem(r.Constants.nonceIdToken)+",Actual Nonce: "+t.nonce),this._logger.error("Nonce Mismatch.Expected Nonce: "+this._cacheStorage.getItem(r.Constants.nonceIdToken)+",Actual Nonce: "+t.nonce)):(this._cacheStorage.setItem(r.Constants.idTokenKey,n.parameters[r.Constants.idToken]),this._cacheStorage.setItem(r.Constants.msalClientInfo,e),this.saveAccessToken(i,n,this._user,e,t)):(this._logger.error("Invalid id_token received in the response"),this._cacheStorage.setItem(r.Constants.msalError,"invalid idToken"),this._cacheStorage.setItem(r.Constants.msalErrorDescription,"Invalid idToken. idToken: "+n.parameters[r.Constants.idToken])))):(this._logger.error("State Mismatch.Expected State: "+this._cacheStorage.getItem(r.Constants.stateLogin)+",Actual State: "+n.stateResponse),this._cacheStorage.setItem(r.Constants.msalError,"Invalid_state"),this._cacheStorage.setItem(r.Constants.msalErrorDescription,"Invalid_state. state: "+n.stateResponse));this._cacheStorage.setItem(r.Constants.renewStatus+n.stateResponse,r.Constants.tokenRenewStatusCompleted);this._cacheStorage.removeAcquireTokenEntries(f,l)},n.prototype.isCallback=function(n){n=this.getHash(n);var t=u.Utils.deserialize(n);return t.hasOwnProperty(r.Constants.errorDescription)||t.hasOwnProperty(r.Constants.error)||t.hasOwnProperty(r.Constants.accessToken)||t.hasOwnProperty(r.Constants.idToken)},n.prototype.getHash=function(n){return n.indexOf("#/")>-1?n=n.substring(n.indexOf("#/")+2):n.indexOf("#")>-1&&(n=n.substring(1)),n},n.prototype.getRequestInfo=function(n){var i,t,f,o,e;if(n=this.getHash(n),i=u.Utils.deserialize(n),t=new w.TokenResponse,i&&(t.parameters=i,i.hasOwnProperty(r.Constants.errorDescription)||i.hasOwnProperty(r.Constants.error)||i.hasOwnProperty(r.Constants.accessToken)||i.hasOwnProperty(r.Constants.idToken))){if(t.valid=!0,f=void 0,!i.hasOwnProperty("state"))return t;if(f=i.state,t.stateResponse=f,f===this._cacheStorage.getItem(r.Constants.stateLogin))return t.requestType=r.Constants.login,t.stateMatch=!0,t;if(f===this._cacheStorage.getItem(r.Constants.stateAcquireToken))return t.requestType=r.Constants.renewToken,t.stateMatch=!0,t;if(!t.stateMatch)for(t.requestType=window.requestType,o=window.renewStates,e=0;e<o.length;e++)if(o[e]===t.stateResponse){t.stateMatch=!0;break}}return t},n.prototype.getScopeFromState=function(n){if(n){var t=n.indexOf("|");if(t>-1&&t+1<n.length)return n.substring(t+1)}return""},n.prototype.isInIframe=function(){return window.parent!==window},n.prototype.loginInProgress=function(){return!!this._cacheStorage.getItem(r.Constants.urlHash)||this._loginInProgress},n.prototype.getHostFromUri=function(n){var t=String(n).replace(/^(https?:)\/\//,"");return t.split("/")[0]},n.prototype.getScopesForEndpoint=function(n){var t,i,r,u;if(this._anonymousEndpoints.length>0)for(t=0;t<this._anonymousEndpoints.length;t++)if(n.indexOf(this._anonymousEndpoints[t])>-1)return null;if(this._endpoints.size>0)for(i=0,r=Array.from(this._endpoints.keys());i<r.length;i++)if(u=r[i],n.indexOf(u)>-1)return this._endpoints.get(u);return n.indexOf("http://")>-1||n.indexOf("https://")>-1?this.getHostFromUri(n)===this.getHostFromUri(this._redirectUri)?new Array(this.clientId):null:new Array(this.clientId)},n.prototype.setloginInProgress=function(n){this._loginInProgress=n},n.prototype.getAcquireTokenInProgress=function(){return this._acquireTokenInProgress},n.prototype.setAcquireTokenInProgress=function(n){this._acquireTokenInProgress=n},n.prototype.getLogger=function(){return this._logger},v.__decorate([b],n.prototype,"acquireTokenSilent",null),n}();t.UserAgentApplication=k},function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),u=function(){function n(n,t,i,u,f){this.authority=n;this.clientId=t;this.scopes=i;this.userIdentifier=r.Utils.base64EncodeStringUrlSafe(u)+"."+r.Utils.base64EncodeStringUrlSafe(f)}return n}();t.AccessTokenKey=u},function(n,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function n(n,t,i,r){this.accessToken=n;this.idToken=t;this.expiresIn=i;this.clientInfo=r}return n}();t.AccessTokenValue=i},function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),u=function(){function n(n,t,i,u,f){this.authorityInstance=n;this.clientId=t;this.scopes=i;this.responseType=u;this.redirectUri=f;this.correlationId=r.Utils.createNewGuid();this.state=r.Utils.createNewGuid();this.nonce=r.Utils.createNewGuid();this.xClientSku="MSAL.JS";this.xClientVer=r.Utils.getLibraryVersion()}return Object.defineProperty(n.prototype,"authority",{get:function(){return this.authorityInstance.CanonicalAuthority},enumerable:!0,configurable:!0}),n.prototype.createNavigateUrl=function(n){var t,i;return n||(n=[this.clientId]),-1===n.indexOf(this.clientId)&&n.push(this.clientId),t=[],t.push("response_type="+this.responseType),this.translateclientIdUsedInScope(n),t.push("scope="+encodeURIComponent(this.parseScope(n))),t.push("client_id="+encodeURIComponent(this.clientId)),t.push("redirect_uri="+encodeURIComponent(this.redirectUri)),t.push("state="+encodeURIComponent(this.state)),t.push("nonce="+encodeURIComponent(this.nonce)),t.push("client_info=1"),t.push("x-client-SKU="+this.xClientSku),t.push("x-client-Ver="+this.xClientVer),this.extraQueryParameters&&t.push(this.extraQueryParameters),t.push("client-request-id="+encodeURIComponent(this.correlationId)),i=this.authorityInstance.AuthorizationEndpoint,i+=i.indexOf("?")<0?"?":"&",""+i+t.join("&")},n.prototype.translateclientIdUsedInScope=function(n){var t=n.indexOf(this.clientId);t>=0&&(n.splice(t,1),-1===n.indexOf("openid")&&n.push("openid"),-1===n.indexOf("profile")&&n.push("profile"))},n.prototype.parseScope=function(n){var i="",t;if(n)for(t=0;t<n.length;++t)i+=t!==n.length-1?n[t]+" ":n[t];return i},n}();t.AuthenticationRequestParameters=u},function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),u=function(){function n(n){if(!n||r.Utils.isEmpty(n))return this.uid="",void(this.utid="");try{var i=r.Utils.base64DecodeStringUrlSafe(n),t=JSON.parse(i);t&&(t.hasOwnProperty("uid")&&(this.uid=t.uid),t.hasOwnProperty("utid")&&(this.utid=t.utid))}catch(n){throw new Error(n);}}return Object.defineProperty(n.prototype,"uid",{get:function(){return this._uid?this._uid:""},set:function(n){this._uid=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"utid",{get:function(){return this._utid?this._utid:""},set:function(n){this._utid=n},enumerable:!0,configurable:!0}),n}();t.ClientInfo=u},function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),u=function(){function n(n){if(r.Utils.isEmpty(n))throw new Error("null or empty raw idtoken");try{this.rawIdToken=n;this.decodedIdToken=r.Utils.extractIdToken(n);this.decodedIdToken&&(this.decodedIdToken.hasOwnProperty("iss")&&(this.issuer=this.decodedIdToken.iss),this.decodedIdToken.hasOwnProperty("oid")&&(this.objectId=this.decodedIdToken.oid),this.decodedIdToken.hasOwnProperty("sub")&&(this.subject=this.decodedIdToken.sub),this.decodedIdToken.hasOwnProperty("tid")&&(this.tenantId=this.decodedIdToken.tid),this.decodedIdToken.hasOwnProperty("ver")&&(this.version=this.decodedIdToken.ver),this.decodedIdToken.hasOwnProperty("preferred_username")&&(this.preferredName=this.decodedIdToken.preferred_username),this.decodedIdToken.hasOwnProperty("name")&&(this.name=this.decodedIdToken.name),this.decodedIdToken.hasOwnProperty("nonce")&&(this.nonce=this.decodedIdToken.nonce),this.decodedIdToken.hasOwnProperty("exp")&&(this.expiration=this.decodedIdToken.exp),this.decodedIdToken.hasOwnProperty("home_oid")&&(this.homeObjectId=this.decodedIdToken.home_oid))}catch(n){throw new Error("Failed to parse the returned id token");}}return n}();t.IdToken=u},function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(3),u=i(19),f=function(){function n(t){if(n._instance)return n._instance;if(this._cacheLocation=t,this._localStorageSupported=void 0!==window[this._cacheLocation]&&null!=window[this._cacheLocation],this._sessionStorageSupported=void 0!==window[t]&&null!=window[t],n._instance=this,!this._localStorageSupported&&!this._sessionStorageSupported)throw new Error("localStorage and sessionStorage not supported");return n._instance}return n.prototype.setItem=function(n,t){if(!window[this._cacheLocation])throw new Error("localStorage and sessionStorage are not supported");window[this._cacheLocation].setItem(n,t)},n.prototype.getItem=function(n){if(window[this._cacheLocation])return window[this._cacheLocation].getItem(n);throw new Error("localStorage and sessionStorage are not supported");},n.prototype.removeItem=function(n){if(window[this._cacheLocation])return window[this._cacheLocation].removeItem(n);throw new Error("localStorage and sessionStorage are not supported");},n.prototype.clear=function(){if(window[this._cacheLocation])return window[this._cacheLocation].clear();throw new Error("localStorage and sessionStorage are not supported");},n.prototype.getAllAccessTokens=function(n,t){var e,o=[],r=window[this._cacheLocation],i,f;if(!r)throw new Error("localStorage and sessionStorage are not supported");i=void 0;for(i in r)r.hasOwnProperty(i)&&i.match(n)&&i.match(t)&&(f=this.getItem(i),f&&(e=new u.AccessTokenCacheItem(JSON.parse(i),JSON.parse(f)),o.push(e)));return o},n.prototype.removeAcquireTokenEntries=function(n,t){var r=window[this._cacheLocation],i;if(!r)throw new Error("localStorage and sessionStorage are not supported");i=void 0;for(i in r)r.hasOwnProperty(i)&&(""!=n&&i.indexOf(n)>-1||""!=t&&i.indexOf(t)>-1)&&this.removeItem(i)},n.prototype.resetCacheItems=function(){var t=window[this._cacheLocation],n;if(!t)throw new Error("localStorage and sessionStorage are not supported");n=void 0;for(n in t)t.hasOwnProperty(n)&&-1!==n.indexOf(r.Constants.msal)&&this.setItem(n,""),t.hasOwnProperty(n)&&-1!==n.indexOf(r.Constants.renewStatus)&&this.removeItem(n)},n}();t.Storage=f},function(n,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function n(n,t){this.key=n;this.value=t}return n}();t.AccessTokenCacheItem=i},function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=i(0),f=i(8),e=i(21),r=i(1),o=i(5),s=function(){function n(){}return n.DetectAuthorityFromUrl=function(n){switch(n=u.Utils.CanonicalizeUri(n),u.Utils.GetUrlComponents(n).PathSegments[0]){case"tfp":return r.AuthorityType.B2C;case"adfs":return r.AuthorityType.Adfs;default:return r.AuthorityType.Aad}},n.CreateInstance=function(t,i){switch(n.DetectAuthorityFromUrl(t)){case r.AuthorityType.B2C:return new e.B2cAuthority(t,i);case r.AuthorityType.Aad:return new f.AadAuthority(t,i);default:throw o.ErrorMessage.invalidAuthorityType;}},n}();t.AuthorityFactory=s},function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=i(2),f=i(8),e=i(1),r=i(5),o=i(0),s=function(n){function t(t,i){var f=n.call(this,t,i)||this,e=o.Utils.GetUrlComponents(t),u=e.PathSegments;if(u.length<3)throw r.ErrorMessage.b2cAuthorityUriInvalidPath;return f.CanonicalAuthority="https://"+e.HostNameAndPort+"/"+u[0]+"/"+u[1]+"/"+u[2]+"/",f}return u.__extends(t,n),Object.defineProperty(t.prototype,"AuthorityType",{get:function(){return e.AuthorityType.B2C},enumerable:!0,configurable:!0}),t.prototype.GetOpenIdConfigurationEndpointAsync=function(){var t=this,n=new Promise(function(n){return n(t.DefaultOpenIdConfigurationEndpoint)});return this.IsValidationEnabled?this.IsInTrustedHostList(this.CanonicalAuthorityUrlComponents.HostNameAndPort)?n:new Promise(function(n,t){return t(r.ErrorMessage.unsupportedAuthorityValidation)}):n},t}(f.AadAuthority);t.B2cAuthority=s}])});